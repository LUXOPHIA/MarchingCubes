unit LUX.FMX.Marcubes;

interface //#################################################################### ■

uses System.Classes, System.Math.Vectors, System.Generics.Collections,
     FMX.Types3D, FMX.Controls3D, FMX.MaterialSources,
     LUX, LUX.D3, LUX.Data.Lattice.T3.D3;

type //$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$【型】

     TMarcubes = class;

     //$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$【レコード】

     //%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% TVert

     TPoin = record
       Pos :TPoint3D;
       Nor :TPoint3D;
     end;

     //%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% TTrias

     TTrias = record
       TsN :Integer;
       Ts  :array[ 1..5 ] of TShortint3D;
     end;

     //$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$【クラス】

     //%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% TIterMarcube

     IIterMarcube = interface( ISingleBricIterGridArray3D )
     ['{8FD59B4C-2D40-4262-A737-AD4FAC4B55E3}']
     {protected}
       ///// アクセス
       function GetKind :Byte;
     {public}
       ///// プロパティ
       property Kind :Byte read GetKind;
     end;

     //-------------------------------------------------------------------------

     TIterMarcube = class( TSingleBricIterGridArray3D, IIterMarcube )
     private
     protected type
     protected
       ///// アクセス
       function GetKind :Byte;
     public
       ///// プロパティ
       property Kind :Byte read GetKind;
     end;

     //%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% TMarcubes

     TMarcubes = class( TControl3D )
     private
     protected
       _Geometry :TMeshData;
       _Material :TMaterialSource;
       _Grids    :TSingleGridArray3D;
       ///// アクセス
       ///// メソッド
       procedure Render; override;
     public
       constructor Create( AOwner_:TComponent ); override;
       destructor Destroy; override;
       ///// プロパティ
       property Material :TMaterialSource    read _Material write _Material;
       property Grids    :TSingleGridArray3D read _Grids;
       ///// メソッド
       procedure EndUpdate; override;
       procedure MakeModel;
     end;

const //$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$【定数】

      TRIASTABLE :array[ 0..255 ] of TTrias = (
        ( TsN:0; Ts:( ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:1; Ts:( ( _1:00; _2:04; _3:09 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:1; Ts:( ( _1:00; _2:08; _3:06 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:2; Ts:( ( _1:08; _2:04; _3:09 ), ( _1:06; _2:04; _3:08 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:1; Ts:( ( _1:01; _2:11; _3:04 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:2; Ts:( ( _1:01; _2:09; _3:00 ), ( _1:11; _2:09; _3:01 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:2; Ts:( ( _1:00; _2:08; _3:06 ), ( _1:04; _2:01; _3:11 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:3; Ts:( ( _1:01; _2:08; _3:06 ), ( _1:01; _2:11; _3:08 ), ( _1:11; _2:09; _3:08 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:1; Ts:( ( _1:06; _2:10; _3:01 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:2; Ts:( ( _1:06; _2:10; _3:01 ), ( _1:00; _2:04; _3:09 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:2; Ts:( ( _1:00; _2:10; _3:01 ), ( _1:08; _2:10; _3:00 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:3; Ts:( ( _1:04; _2:10; _3:01 ), ( _1:04; _2:09; _3:10 ), ( _1:09; _2:08; _3:10 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:2; Ts:( ( _1:06; _2:11; _3:04 ), ( _1:10; _2:11; _3:06 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:3; Ts:( ( _1:06; _2:09; _3:00 ), ( _1:06; _2:10; _3:09 ), ( _1:10; _2:11; _3:09 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:3; Ts:( ( _1:00; _2:11; _3:04 ), ( _1:00; _2:08; _3:11 ), ( _1:08; _2:10; _3:11 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:2; Ts:( ( _1:08; _2:10; _3:09 ), ( _1:09; _2:10; _3:11 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:1; Ts:( ( _1:09; _2:05; _3:02 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:2; Ts:( ( _1:00; _2:05; _3:02 ), ( _1:04; _2:05; _3:00 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:2; Ts:( ( _1:08; _2:06; _3:00 ), ( _1:02; _2:09; _3:05 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:3; Ts:( ( _1:08; _2:05; _3:02 ), ( _1:08; _2:06; _3:05 ), ( _1:06; _2:04; _3:05 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:2; Ts:( ( _1:04; _2:01; _3:11 ), ( _1:09; _2:05; _3:02 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:3; Ts:( ( _1:05; _2:01; _3:11 ), ( _1:05; _2:02; _3:01 ), ( _1:02; _2:00; _3:01 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:3; Ts:( ( _1:06; _2:00; _3:08 ), ( _1:04; _2:01; _3:11 ), ( _1:02; _2:09; _3:05 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:4; Ts:( ( _1:01; _2:11; _3:05 ), ( _1:06; _2:01; _3:05 ), ( _1:06; _2:05; _3:02 ), ( _1:06; _2:02; _3:08 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:2; Ts:( ( _1:06; _2:10; _3:01 ), ( _1:02; _2:09; _3:05 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:3; Ts:( ( _1:00; _2:05; _3:02 ), ( _1:00; _2:04; _3:05 ), ( _1:01; _2:06; _3:10 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:3; Ts:( ( _1:00; _2:10; _3:01 ), ( _1:00; _2:08; _3:10 ), ( _1:02; _2:09; _3:05 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:4; Ts:( ( _1:02; _2:08; _3:10 ), ( _1:02; _2:10; _3:04 ), ( _1:02; _2:04; _3:05 ), ( _1:01; _2:04; _3:10 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:3; Ts:( ( _1:11; _2:06; _3:10 ), ( _1:11; _2:04; _3:06 ), ( _1:09; _2:05; _3:02 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:4; Ts:( ( _1:06; _2:10; _3:11 ), ( _1:06; _2:11; _3:02 ), ( _1:06; _2:02; _3:00 ), ( _1:02; _2:11; _3:05 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:4; Ts:( ( _1:02; _2:09; _3:05 ), ( _1:00; _2:08; _3:04 ), ( _1:08; _2:11; _3:04 ), ( _1:08; _2:10; _3:11 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:3; Ts:( ( _1:05; _2:02; _3:08 ), ( _1:05; _2:08; _3:11 ), ( _1:11; _2:08; _3:10 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:1; Ts:( ( _1:08; _2:02; _3:07 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:2; Ts:( ( _1:00; _2:04; _3:09 ), ( _1:08; _2:02; _3:07 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:2; Ts:( ( _1:06; _2:02; _3:07 ), ( _1:00; _2:02; _3:06 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:3; Ts:( ( _1:02; _2:04; _3:09 ), ( _1:02; _2:07; _3:04 ), ( _1:07; _2:06; _3:04 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:2; Ts:( ( _1:08; _2:02; _3:07 ), ( _1:04; _2:01; _3:11 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:3; Ts:( ( _1:09; _2:01; _3:11 ), ( _1:09; _2:00; _3:01 ), ( _1:08; _2:02; _3:07 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:3; Ts:( ( _1:06; _2:02; _3:07 ), ( _1:06; _2:00; _3:02 ), ( _1:04; _2:01; _3:11 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:4; Ts:( ( _1:02; _2:07; _3:06 ), ( _1:02; _2:06; _3:11 ), ( _1:02; _2:11; _3:09 ), ( _1:11; _2:06; _3:01 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:2; Ts:( ( _1:08; _2:02; _3:07 ), ( _1:06; _2:10; _3:01 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:3; Ts:( ( _1:09; _2:00; _3:04 ), ( _1:08; _2:02; _3:07 ), ( _1:01; _2:06; _3:10 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:3; Ts:( ( _1:10; _2:02; _3:07 ), ( _1:10; _2:01; _3:02 ), ( _1:01; _2:00; _3:02 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:4; Ts:( ( _1:02; _2:07; _3:10 ), ( _1:09; _2:02; _3:10 ), ( _1:09; _2:10; _3:01 ), ( _1:09; _2:01; _3:04 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:3; Ts:( ( _1:06; _2:11; _3:04 ), ( _1:06; _2:10; _3:11 ), ( _1:07; _2:08; _3:02 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:4; Ts:( ( _1:07; _2:08; _3:02 ), ( _1:06; _2:10; _3:00 ), ( _1:10; _2:09; _3:00 ), ( _1:10; _2:11; _3:09 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:4; Ts:( ( _1:04; _2:00; _3:02 ), ( _1:04; _2:02; _3:10 ), ( _1:04; _2:10; _3:11 ), ( _1:07; _2:10; _3:02 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:3; Ts:( ( _1:02; _2:07; _3:10 ), ( _1:02; _2:10; _3:09 ), ( _1:09; _2:10; _3:11 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:2; Ts:( ( _1:09; _2:07; _3:08 ), ( _1:05; _2:07; _3:09 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:3; Ts:( ( _1:00; _2:07; _3:08 ), ( _1:00; _2:04; _3:07 ), ( _1:04; _2:05; _3:07 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:3; Ts:( ( _1:09; _2:06; _3:00 ), ( _1:09; _2:05; _3:06 ), ( _1:05; _2:07; _3:06 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:2; Ts:( ( _1:06; _2:04; _3:07 ), ( _1:07; _2:04; _3:05 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:3; Ts:( ( _1:09; _2:07; _3:08 ), ( _1:09; _2:05; _3:07 ), ( _1:11; _2:04; _3:01 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:4; Ts:( ( _1:08; _2:05; _3:07 ), ( _1:08; _2:01; _3:05 ), ( _1:08; _2:00; _3:01 ), ( _1:11; _2:05; _3:01 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:4; Ts:( ( _1:01; _2:11; _3:04 ), ( _1:06; _2:00; _3:05 ), ( _1:06; _2:05; _3:07 ), ( _1:05; _2:00; _3:09 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:3; Ts:( ( _1:01; _2:11; _3:05 ), ( _1:01; _2:05; _3:06 ), ( _1:06; _2:05; _3:07 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:3; Ts:( ( _1:07; _2:09; _3:05 ), ( _1:07; _2:08; _3:09 ), ( _1:06; _2:10; _3:01 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:4; Ts:( ( _1:01; _2:06; _3:10 ), ( _1:00; _2:04; _3:08 ), ( _1:04; _2:07; _3:08 ), ( _1:04; _2:05; _3:07 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:4; Ts:( ( _1:10; _2:01; _3:00 ), ( _1:10; _2:00; _3:05 ), ( _1:10; _2:05; _3:07 ), ( _1:05; _2:00; _3:09 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:3; Ts:( ( _1:10; _2:01; _3:04 ), ( _1:10; _2:04; _3:07 ), ( _1:07; _2:04; _3:05 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:4; Ts:( ( _1:06; _2:10; _3:04 ), ( _1:04; _2:10; _3:11 ), ( _1:07; _2:08; _3:09 ), ( _1:07; _2:09; _3:05 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:5; Ts:( ( _1:10; _2:11; _3:00 ), ( _1:10; _2:00; _3:06 ), ( _1:11; _2:05; _3:00 ), ( _1:08; _2:00; _3:07 ), ( _1:05; _2:07; _3:00 ) ) ),
        ( TsN:5; Ts:( ( _1:05; _2:07; _3:00 ), ( _1:05; _2:00; _3:09 ), ( _1:07; _2:10; _3:00 ), ( _1:04; _2:00; _3:11 ), ( _1:10; _2:11; _3:00 ) ) ),
        ( TsN:2; Ts:( ( _1:05; _2:07; _3:10 ), ( _1:11; _2:05; _3:10 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:1; Ts:( ( _1:11; _2:03; _3:05 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:2; Ts:( ( _1:09; _2:00; _3:04 ), ( _1:05; _2:11; _3:03 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:2; Ts:( ( _1:00; _2:08; _3:06 ), ( _1:05; _2:11; _3:03 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:3; Ts:( ( _1:04; _2:08; _3:06 ), ( _1:04; _2:09; _3:08 ), ( _1:05; _2:11; _3:03 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:2; Ts:( ( _1:03; _2:04; _3:01 ), ( _1:05; _2:04; _3:03 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:3; Ts:( ( _1:09; _2:03; _3:05 ), ( _1:09; _2:00; _3:03 ), ( _1:00; _2:01; _3:03 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:3; Ts:( ( _1:04; _2:03; _3:05 ), ( _1:04; _2:01; _3:03 ), ( _1:06; _2:00; _3:08 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:4; Ts:( ( _1:06; _2:01; _3:03 ), ( _1:06; _2:03; _3:09 ), ( _1:06; _2:09; _3:08 ), ( _1:05; _2:09; _3:03 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:2; Ts:( ( _1:01; _2:06; _3:10 ), ( _1:11; _2:03; _3:05 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:3; Ts:( ( _1:00; _2:04; _3:09 ), ( _1:01; _2:06; _3:10 ), ( _1:05; _2:11; _3:03 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:3; Ts:( ( _1:10; _2:00; _3:08 ), ( _1:10; _2:01; _3:00 ), ( _1:11; _2:03; _3:05 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:4; Ts:( ( _1:05; _2:11; _3:03 ), ( _1:04; _2:09; _3:01 ), ( _1:09; _2:10; _3:01 ), ( _1:09; _2:08; _3:10 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:3; Ts:( ( _1:03; _2:06; _3:10 ), ( _1:03; _2:05; _3:06 ), ( _1:05; _2:04; _3:06 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:4; Ts:( ( _1:09; _2:03; _3:05 ), ( _1:00; _2:03; _3:09 ), ( _1:00; _2:10; _3:03 ), ( _1:00; _2:06; _3:10 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:4; Ts:( ( _1:00; _2:05; _3:04 ), ( _1:00; _2:10; _3:05 ), ( _1:00; _2:08; _3:10 ), ( _1:10; _2:03; _3:05 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:3; Ts:( ( _1:03; _2:05; _3:09 ), ( _1:03; _2:09; _3:10 ), ( _1:10; _2:09; _3:08 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:2; Ts:( ( _1:11; _2:02; _3:09 ), ( _1:03; _2:02; _3:11 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:3; Ts:( ( _1:11; _2:00; _3:04 ), ( _1:11; _2:03; _3:00 ), ( _1:03; _2:02; _3:00 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:3; Ts:( ( _1:02; _2:11; _3:03 ), ( _1:02; _2:09; _3:11 ), ( _1:00; _2:08; _3:06 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:4; Ts:( ( _1:08; _2:03; _3:02 ), ( _1:08; _2:04; _3:03 ), ( _1:08; _2:06; _3:04 ), ( _1:04; _2:11; _3:03 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:3; Ts:( ( _1:04; _2:02; _3:09 ), ( _1:04; _2:01; _3:02 ), ( _1:01; _2:03; _3:02 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:2; Ts:( ( _1:00; _2:01; _3:02 ), ( _1:01; _2:03; _3:02 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:4; Ts:( ( _1:08; _2:06; _3:00 ), ( _1:02; _2:09; _3:01 ), ( _1:02; _2:01; _3:03 ), ( _1:01; _2:09; _3:04 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:3; Ts:( ( _1:08; _2:06; _3:01 ), ( _1:08; _2:01; _3:02 ), ( _1:02; _2:01; _3:03 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:3; Ts:( ( _1:11; _2:02; _3:09 ), ( _1:11; _2:03; _3:02 ), ( _1:10; _2:01; _3:06 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:4; Ts:( ( _1:06; _2:10; _3:01 ), ( _1:00; _2:04; _3:03 ), ( _1:00; _2:03; _3:02 ), ( _1:03; _2:04; _3:11 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:4; Ts:( ( _1:09; _2:03; _3:02 ), ( _1:09; _2:11; _3:03 ), ( _1:08; _2:10; _3:00 ), ( _1:10; _2:01; _3:00 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:5; Ts:( ( _1:03; _2:02; _3:04 ), ( _1:03; _2:04; _3:11 ), ( _1:02; _2:08; _3:04 ), ( _1:01; _2:04; _3:10 ), ( _1:08; _2:10; _3:04 ) ) ),
        ( TsN:4; Ts:( ( _1:10; _2:04; _3:06 ), ( _1:10; _2:02; _3:04 ), ( _1:10; _2:03; _3:02 ), ( _1:09; _2:04; _3:02 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:3; Ts:( ( _1:06; _2:10; _3:03 ), ( _1:06; _2:03; _3:00 ), ( _1:00; _2:03; _3:02 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:5; Ts:( ( _1:08; _2:10; _3:04 ), ( _1:08; _2:04; _3:00 ), ( _1:10; _2:03; _3:04 ), ( _1:09; _2:04; _3:02 ), ( _1:03; _2:02; _3:04 ) ) ),
        ( TsN:2; Ts:( ( _1:08; _2:10; _3:03 ), ( _1:02; _2:08; _3:03 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:2; Ts:( ( _1:07; _2:08; _3:02 ), ( _1:03; _2:05; _3:11 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:3; Ts:( ( _1:08; _2:02; _3:07 ), ( _1:09; _2:00; _3:04 ), ( _1:03; _2:05; _3:11 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:3; Ts:( ( _1:02; _2:06; _3:00 ), ( _1:02; _2:07; _3:06 ), ( _1:03; _2:05; _3:11 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:4; Ts:( ( _1:03; _2:05; _3:11 ), ( _1:02; _2:07; _3:09 ), ( _1:07; _2:04; _3:09 ), ( _1:07; _2:06; _3:04 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:3; Ts:( ( _1:03; _2:04; _3:01 ), ( _1:03; _2:05; _3:04 ), ( _1:02; _2:07; _3:08 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:4; Ts:( ( _1:08; _2:02; _3:07 ), ( _1:09; _2:00; _3:05 ), ( _1:00; _2:03; _3:05 ), ( _1:00; _2:01; _3:03 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:4; Ts:( ( _1:01; _2:05; _3:04 ), ( _1:01; _2:03; _3:05 ), ( _1:00; _2:02; _3:06 ), ( _1:02; _2:07; _3:06 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:5; Ts:( ( _1:07; _2:06; _3:09 ), ( _1:07; _2:09; _3:02 ), ( _1:06; _2:01; _3:09 ), ( _1:05; _2:09; _3:03 ), ( _1:01; _2:03; _3:09 ) ) ),
        ( TsN:3; Ts:( ( _1:06; _2:10; _3:01 ), ( _1:07; _2:08; _3:02 ), ( _1:11; _2:03; _3:05 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:4; Ts:( ( _1:03; _2:05; _3:11 ), ( _1:08; _2:02; _3:07 ), ( _1:00; _2:04; _3:09 ), ( _1:01; _2:06; _3:10 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:4; Ts:( ( _1:11; _2:03; _3:05 ), ( _1:10; _2:01; _3:07 ), ( _1:01; _2:02; _3:07 ), ( _1:01; _2:00; _3:02 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:5; Ts:( ( _1:09; _2:01; _3:04 ), ( _1:09; _2:10; _3:01 ), ( _1:09; _2:02; _3:10 ), ( _1:07; _2:10; _3:02 ), ( _1:05; _2:11; _3:03 ) ) ),
        ( TsN:4; Ts:( ( _1:08; _2:02; _3:07 ), ( _1:06; _2:10; _3:05 ), ( _1:06; _2:05; _3:04 ), ( _1:05; _2:10; _3:03 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:5; Ts:( ( _1:00; _2:05; _3:09 ), ( _1:00; _2:03; _3:05 ), ( _1:00; _2:06; _3:03 ), ( _1:10; _2:03; _3:06 ), ( _1:08; _2:02; _3:07 ) ) ),
        ( TsN:5; Ts:( ( _1:05; _2:04; _3:10 ), ( _1:05; _2:10; _3:03 ), ( _1:04; _2:00; _3:10 ), ( _1:07; _2:10; _3:02 ), ( _1:00; _2:02; _3:10 ) ) ),
        ( TsN:4; Ts:( ( _1:03; _2:05; _3:09 ), ( _1:03; _2:09; _3:10 ), ( _1:02; _2:07; _3:09 ), ( _1:07; _2:10; _3:09 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:3; Ts:( ( _1:07; _2:11; _3:03 ), ( _1:07; _2:08; _3:11 ), ( _1:08; _2:09; _3:11 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:4; Ts:( ( _1:07; _2:11; _3:03 ), ( _1:08; _2:11; _3:07 ), ( _1:08; _2:04; _3:11 ), ( _1:08; _2:00; _3:04 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:4; Ts:( ( _1:00; _2:09; _3:11 ), ( _1:00; _2:11; _3:07 ), ( _1:00; _2:07; _3:06 ), ( _1:03; _2:07; _3:11 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:3; Ts:( ( _1:11; _2:03; _3:07 ), ( _1:11; _2:07; _3:04 ), ( _1:04; _2:07; _3:06 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:4; Ts:( ( _1:04; _2:08; _3:09 ), ( _1:04; _2:03; _3:08 ), ( _1:04; _2:01; _3:03 ), ( _1:03; _2:07; _3:08 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:3; Ts:( ( _1:07; _2:08; _3:00 ), ( _1:07; _2:00; _3:03 ), ( _1:03; _2:00; _3:01 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:5; Ts:( ( _1:01; _2:03; _3:09 ), ( _1:01; _2:09; _3:04 ), ( _1:03; _2:07; _3:09 ), ( _1:00; _2:09; _3:06 ), ( _1:07; _2:06; _3:09 ) ) ),
        ( TsN:2; Ts:( ( _1:07; _2:06; _3:01 ), ( _1:03; _2:07; _3:01 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:4; Ts:( ( _1:06; _2:10; _3:01 ), ( _1:07; _2:08; _3:03 ), ( _1:08; _2:11; _3:03 ), ( _1:08; _2:09; _3:11 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:5; Ts:( ( _1:08; _2:03; _3:07 ), ( _1:08; _2:11; _3:03 ), ( _1:08; _2:00; _3:11 ), ( _1:04; _2:11; _3:00 ), ( _1:06; _2:10; _3:01 ) ) ),
        ( TsN:5; Ts:( ( _1:01; _2:00; _3:07 ), ( _1:01; _2:07; _3:10 ), ( _1:00; _2:09; _3:07 ), ( _1:03; _2:07; _3:11 ), ( _1:09; _2:11; _3:07 ) ) ),
        ( TsN:4; Ts:( ( _1:11; _2:03; _3:07 ), ( _1:11; _2:07; _3:04 ), ( _1:10; _2:01; _3:07 ), ( _1:01; _2:04; _3:07 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:5; Ts:( ( _1:08; _2:09; _3:03 ), ( _1:08; _2:03; _3:07 ), ( _1:09; _2:04; _3:03 ), ( _1:10; _2:03; _3:06 ), ( _1:04; _2:06; _3:03 ) ) ),
        ( TsN:4; Ts:( ( _1:07; _2:08; _3:00 ), ( _1:07; _2:00; _3:03 ), ( _1:06; _2:10; _3:00 ), ( _1:10; _2:03; _3:00 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:2; Ts:( ( _1:00; _2:09; _3:04 ), ( _1:10; _2:03; _3:07 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:1; Ts:( ( _1:07; _2:10; _3:03 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:1; Ts:( ( _1:07; _2:03; _3:10 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:2; Ts:( ( _1:00; _2:04; _3:09 ), ( _1:10; _2:07; _3:03 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:2; Ts:( ( _1:06; _2:00; _3:08 ), ( _1:10; _2:07; _3:03 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:3; Ts:( ( _1:08; _2:04; _3:09 ), ( _1:08; _2:06; _3:04 ), ( _1:10; _2:07; _3:03 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:2; Ts:( ( _1:10; _2:07; _3:03 ), ( _1:01; _2:11; _3:04 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:3; Ts:( ( _1:01; _2:09; _3:00 ), ( _1:01; _2:11; _3:09 ), ( _1:03; _2:10; _3:07 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:3; Ts:( ( _1:08; _2:06; _3:00 ), ( _1:10; _2:07; _3:03 ), ( _1:04; _2:01; _3:11 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:4; Ts:( ( _1:07; _2:03; _3:10 ), ( _1:08; _2:06; _3:11 ), ( _1:08; _2:11; _3:09 ), ( _1:11; _2:06; _3:01 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:2; Ts:( ( _1:07; _2:01; _3:06 ), ( _1:03; _2:01; _3:07 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:3; Ts:( ( _1:01; _2:07; _3:03 ), ( _1:01; _2:06; _3:07 ), ( _1:00; _2:04; _3:09 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:3; Ts:( ( _1:07; _2:00; _3:08 ), ( _1:07; _2:03; _3:00 ), ( _1:03; _2:01; _3:00 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:4; Ts:( ( _1:04; _2:09; _3:08 ), ( _1:04; _2:08; _3:03 ), ( _1:04; _2:03; _3:01 ), ( _1:03; _2:08; _3:07 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:3; Ts:( ( _1:11; _2:07; _3:03 ), ( _1:11; _2:04; _3:07 ), ( _1:04; _2:06; _3:07 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:4; Ts:( ( _1:00; _2:11; _3:09 ), ( _1:00; _2:07; _3:11 ), ( _1:00; _2:06; _3:07 ), ( _1:03; _2:11; _3:07 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:4; Ts:( ( _1:07; _2:03; _3:11 ), ( _1:08; _2:07; _3:11 ), ( _1:08; _2:11; _3:04 ), ( _1:08; _2:04; _3:00 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:3; Ts:( ( _1:07; _2:03; _3:11 ), ( _1:07; _2:11; _3:08 ), ( _1:08; _2:11; _3:09 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:2; Ts:( ( _1:02; _2:09; _3:05 ), ( _1:07; _2:03; _3:10 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:3; Ts:( ( _1:05; _2:00; _3:04 ), ( _1:05; _2:02; _3:00 ), ( _1:07; _2:03; _3:10 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:3; Ts:( ( _1:00; _2:08; _3:06 ), ( _1:02; _2:09; _3:05 ), ( _1:10; _2:07; _3:03 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:4; Ts:( ( _1:10; _2:07; _3:03 ), ( _1:08; _2:06; _3:02 ), ( _1:06; _2:05; _3:02 ), ( _1:06; _2:04; _3:05 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:3; Ts:( ( _1:09; _2:05; _3:02 ), ( _1:11; _2:04; _3:01 ), ( _1:07; _2:03; _3:10 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:4; Ts:( ( _1:10; _2:07; _3:03 ), ( _1:01; _2:11; _3:02 ), ( _1:01; _2:02; _3:00 ), ( _1:02; _2:11; _3:05 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:4; Ts:( ( _1:00; _2:08; _3:06 ), ( _1:01; _2:11; _3:04 ), ( _1:02; _2:09; _3:05 ), ( _1:10; _2:07; _3:03 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:5; Ts:( ( _1:06; _2:02; _3:08 ), ( _1:06; _2:05; _3:02 ), ( _1:06; _2:01; _3:05 ), ( _1:11; _2:05; _3:01 ), ( _1:10; _2:07; _3:03 ) ) ),
        ( TsN:3; Ts:( ( _1:07; _2:01; _3:06 ), ( _1:07; _2:03; _3:01 ), ( _1:05; _2:02; _3:09 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:4; Ts:( ( _1:00; _2:04; _3:02 ), ( _1:02; _2:04; _3:05 ), ( _1:01; _2:06; _3:07 ), ( _1:01; _2:07; _3:03 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:4; Ts:( ( _1:09; _2:05; _3:02 ), ( _1:00; _2:08; _3:03 ), ( _1:00; _2:03; _3:01 ), ( _1:03; _2:08; _3:07 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:5; Ts:( ( _1:03; _2:01; _3:08 ), ( _1:03; _2:08; _3:07 ), ( _1:01; _2:04; _3:08 ), ( _1:02; _2:08; _3:05 ), ( _1:04; _2:05; _3:08 ) ) ),
        ( TsN:4; Ts:( ( _1:02; _2:09; _3:05 ), ( _1:07; _2:03; _3:04 ), ( _1:07; _2:04; _3:06 ), ( _1:04; _2:03; _3:11 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:5; Ts:( ( _1:02; _2:00; _3:11 ), ( _1:02; _2:11; _3:05 ), ( _1:00; _2:06; _3:11 ), ( _1:03; _2:11; _3:07 ), ( _1:06; _2:07; _3:11 ) ) ),
        ( TsN:5; Ts:( ( _1:08; _2:04; _3:00 ), ( _1:08; _2:11; _3:04 ), ( _1:08; _2:07; _3:11 ), ( _1:03; _2:11; _3:07 ), ( _1:02; _2:09; _3:05 ) ) ),
        ( TsN:4; Ts:( ( _1:05; _2:02; _3:08 ), ( _1:05; _2:08; _3:11 ), ( _1:07; _2:03; _3:08 ), ( _1:03; _2:11; _3:08 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:2; Ts:( ( _1:08; _2:03; _3:10 ), ( _1:02; _2:03; _3:08 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:3; Ts:( ( _1:08; _2:03; _3:10 ), ( _1:08; _2:02; _3:03 ), ( _1:09; _2:00; _3:04 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:3; Ts:( ( _1:06; _2:03; _3:10 ), ( _1:06; _2:00; _3:03 ), ( _1:00; _2:02; _3:03 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:4; Ts:( ( _1:10; _2:06; _3:04 ), ( _1:10; _2:04; _3:02 ), ( _1:10; _2:02; _3:03 ), ( _1:09; _2:02; _3:04 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:3; Ts:( ( _1:03; _2:08; _3:02 ), ( _1:03; _2:10; _3:08 ), ( _1:01; _2:11; _3:04 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:4; Ts:( ( _1:08; _2:02; _3:10 ), ( _1:10; _2:02; _3:03 ), ( _1:09; _2:00; _3:01 ), ( _1:09; _2:01; _3:11 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:4; Ts:( ( _1:04; _2:01; _3:11 ), ( _1:06; _2:00; _3:10 ), ( _1:00; _2:03; _3:10 ), ( _1:00; _2:02; _3:03 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:5; Ts:( ( _1:11; _2:09; _3:06 ), ( _1:11; _2:06; _3:01 ), ( _1:09; _2:02; _3:06 ), ( _1:10; _2:06; _3:03 ), ( _1:02; _2:03; _3:06 ) ) ),
        ( TsN:3; Ts:( ( _1:08; _2:01; _3:06 ), ( _1:08; _2:02; _3:01 ), ( _1:02; _2:03; _3:01 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:4; Ts:( ( _1:09; _2:00; _3:04 ), ( _1:08; _2:02; _3:06 ), ( _1:02; _2:01; _3:06 ), ( _1:02; _2:03; _3:01 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:2; Ts:( ( _1:00; _2:02; _3:01 ), ( _1:01; _2:02; _3:03 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:3; Ts:( ( _1:04; _2:09; _3:02 ), ( _1:04; _2:02; _3:01 ), ( _1:01; _2:02; _3:03 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:4; Ts:( ( _1:08; _2:02; _3:03 ), ( _1:08; _2:03; _3:04 ), ( _1:08; _2:04; _3:06 ), ( _1:04; _2:03; _3:11 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:5; Ts:( ( _1:02; _2:03; _3:06 ), ( _1:02; _2:06; _3:08 ), ( _1:03; _2:11; _3:06 ), ( _1:00; _2:06; _3:09 ), ( _1:11; _2:09; _3:06 ) ) ),
        ( TsN:3; Ts:( ( _1:11; _2:04; _3:00 ), ( _1:11; _2:00; _3:03 ), ( _1:03; _2:00; _3:02 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:2; Ts:( ( _1:11; _2:09; _3:02 ), ( _1:03; _2:11; _3:02 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:3; Ts:( ( _1:03; _2:09; _3:05 ), ( _1:03; _2:10; _3:09 ), ( _1:10; _2:08; _3:09 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:4; Ts:( ( _1:00; _2:04; _3:05 ), ( _1:00; _2:05; _3:10 ), ( _1:00; _2:10; _3:08 ), ( _1:10; _2:05; _3:03 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:4; Ts:( ( _1:09; _2:05; _3:03 ), ( _1:00; _2:09; _3:03 ), ( _1:00; _2:03; _3:10 ), ( _1:00; _2:10; _3:06 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:3; Ts:( ( _1:03; _2:10; _3:06 ), ( _1:03; _2:06; _3:05 ), ( _1:05; _2:06; _3:04 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:4; Ts:( ( _1:04; _2:01; _3:11 ), ( _1:09; _2:05; _3:10 ), ( _1:09; _2:10; _3:08 ), ( _1:10; _2:05; _3:03 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:5; Ts:( ( _1:10; _2:08; _3:05 ), ( _1:10; _2:05; _3:03 ), ( _1:08; _2:00; _3:05 ), ( _1:11; _2:05; _3:01 ), ( _1:00; _2:01; _3:05 ) ) ),
        ( TsN:5; Ts:( ( _1:00; _2:10; _3:06 ), ( _1:00; _2:03; _3:10 ), ( _1:00; _2:09; _3:03 ), ( _1:05; _2:03; _3:09 ), ( _1:04; _2:01; _3:11 ) ) ),
        ( TsN:4; Ts:( ( _1:03; _2:10; _3:06 ), ( _1:03; _2:06; _3:05 ), ( _1:01; _2:11; _3:06 ), ( _1:11; _2:05; _3:06 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:4; Ts:( ( _1:06; _2:03; _3:01 ), ( _1:06; _2:09; _3:03 ), ( _1:06; _2:08; _3:09 ), ( _1:05; _2:03; _3:09 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:5; Ts:( ( _1:04; _2:05; _3:08 ), ( _1:04; _2:08; _3:00 ), ( _1:05; _2:03; _3:08 ), ( _1:06; _2:08; _3:01 ), ( _1:03; _2:01; _3:08 ) ) ),
        ( TsN:3; Ts:( ( _1:09; _2:05; _3:03 ), ( _1:09; _2:03; _3:00 ), ( _1:00; _2:03; _3:01 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:2; Ts:( ( _1:03; _2:01; _3:04 ), ( _1:05; _2:03; _3:04 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:5; Ts:( ( _1:04; _2:06; _3:03 ), ( _1:04; _2:03; _3:11 ), ( _1:06; _2:08; _3:03 ), ( _1:05; _2:03; _3:09 ), ( _1:08; _2:09; _3:03 ) ) ),
        ( TsN:2; Ts:( ( _1:00; _2:06; _3:08 ), ( _1:05; _2:03; _3:11 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:4; Ts:( ( _1:11; _2:04; _3:00 ), ( _1:11; _2:00; _3:03 ), ( _1:09; _2:05; _3:00 ), ( _1:05; _2:03; _3:00 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:1; Ts:( ( _1:11; _2:05; _3:03 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:2; Ts:( ( _1:05; _2:10; _3:07 ), ( _1:11; _2:10; _3:05 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:3; Ts:( ( _1:05; _2:10; _3:07 ), ( _1:05; _2:11; _3:10 ), ( _1:04; _2:09; _3:00 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:3; Ts:( ( _1:10; _2:05; _3:11 ), ( _1:10; _2:07; _3:05 ), ( _1:08; _2:06; _3:00 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:4; Ts:( ( _1:07; _2:11; _3:10 ), ( _1:07; _2:05; _3:11 ), ( _1:06; _2:04; _3:08 ), ( _1:04; _2:09; _3:08 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:3; Ts:( ( _1:10; _2:04; _3:01 ), ( _1:10; _2:07; _3:04 ), ( _1:07; _2:05; _3:04 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:4; Ts:( ( _1:10; _2:00; _3:01 ), ( _1:10; _2:05; _3:00 ), ( _1:10; _2:07; _3:05 ), ( _1:05; _2:09; _3:00 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:4; Ts:( ( _1:00; _2:08; _3:06 ), ( _1:04; _2:01; _3:07 ), ( _1:04; _2:07; _3:05 ), ( _1:07; _2:01; _3:10 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:5; Ts:( ( _1:07; _2:05; _3:01 ), ( _1:07; _2:01; _3:10 ), ( _1:05; _2:09; _3:01 ), ( _1:06; _2:01; _3:08 ), ( _1:09; _2:08; _3:01 ) ) ),
        ( TsN:3; Ts:( ( _1:01; _2:05; _3:11 ), ( _1:01; _2:06; _3:05 ), ( _1:06; _2:07; _3:05 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:4; Ts:( ( _1:00; _2:04; _3:09 ), ( _1:01; _2:06; _3:11 ), ( _1:06; _2:05; _3:11 ), ( _1:06; _2:07; _3:05 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:4; Ts:( ( _1:08; _2:07; _3:05 ), ( _1:08; _2:05; _3:01 ), ( _1:08; _2:01; _3:00 ), ( _1:11; _2:01; _3:05 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:5; Ts:( ( _1:09; _2:08; _3:01 ), ( _1:09; _2:01; _3:04 ), ( _1:08; _2:07; _3:01 ), ( _1:11; _2:01; _3:05 ), ( _1:07; _2:05; _3:01 ) ) ),
        ( TsN:2; Ts:( ( _1:06; _2:07; _3:04 ), ( _1:07; _2:05; _3:04 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:3; Ts:( ( _1:09; _2:00; _3:06 ), ( _1:09; _2:06; _3:05 ), ( _1:05; _2:06; _3:07 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:3; Ts:( ( _1:00; _2:08; _3:07 ), ( _1:00; _2:07; _3:04 ), ( _1:04; _2:07; _3:05 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:2; Ts:( ( _1:09; _2:08; _3:07 ), ( _1:05; _2:09; _3:07 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:3; Ts:( ( _1:02; _2:10; _3:07 ), ( _1:02; _2:09; _3:10 ), ( _1:09; _2:11; _3:10 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:4; Ts:( ( _1:04; _2:02; _3:00 ), ( _1:04; _2:10; _3:02 ), ( _1:04; _2:11; _3:10 ), ( _1:07; _2:02; _3:10 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:4; Ts:( ( _1:06; _2:00; _3:08 ), ( _1:10; _2:07; _3:09 ), ( _1:10; _2:09; _3:11 ), ( _1:09; _2:07; _3:02 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:5; Ts:( ( _1:06; _2:04; _3:02 ), ( _1:06; _2:02; _3:08 ), ( _1:04; _2:11; _3:02 ), ( _1:07; _2:02; _3:10 ), ( _1:11; _2:10; _3:02 ) ) ),
        ( TsN:4; Ts:( ( _1:02; _2:10; _3:07 ), ( _1:09; _2:10; _3:02 ), ( _1:09; _2:01; _3:10 ), ( _1:09; _2:04; _3:01 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:3; Ts:( ( _1:10; _2:07; _3:02 ), ( _1:10; _2:02; _3:01 ), ( _1:01; _2:02; _3:00 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:5; Ts:( ( _1:09; _2:07; _3:02 ), ( _1:09; _2:10; _3:07 ), ( _1:09; _2:04; _3:10 ), ( _1:01; _2:10; _3:04 ), ( _1:00; _2:08; _3:06 ) ) ),
        ( TsN:4; Ts:( ( _1:10; _2:07; _3:02 ), ( _1:10; _2:02; _3:01 ), ( _1:08; _2:06; _3:02 ), ( _1:06; _2:01; _3:02 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:4; Ts:( ( _1:02; _2:06; _3:07 ), ( _1:02; _2:11; _3:06 ), ( _1:02; _2:09; _3:11 ), ( _1:11; _2:01; _3:06 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:5; Ts:( ( _1:06; _2:07; _3:11 ), ( _1:06; _2:11; _3:01 ), ( _1:07; _2:02; _3:11 ), ( _1:04; _2:11; _3:00 ), ( _1:02; _2:00; _3:11 ) ) ),
        ( TsN:5; Ts:( ( _1:09; _2:11; _3:07 ), ( _1:09; _2:07; _3:02 ), ( _1:11; _2:01; _3:07 ), ( _1:08; _2:07; _3:00 ), ( _1:01; _2:00; _3:07 ) ) ),
        ( TsN:2; Ts:( ( _1:08; _2:07; _3:02 ), ( _1:04; _2:11; _3:01 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:3; Ts:( ( _1:02; _2:09; _3:04 ), ( _1:02; _2:04; _3:07 ), ( _1:07; _2:04; _3:06 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:2; Ts:( ( _1:06; _2:07; _3:02 ), ( _1:00; _2:06; _3:02 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:4; Ts:( ( _1:02; _2:09; _3:04 ), ( _1:02; _2:04; _3:07 ), ( _1:00; _2:08; _3:04 ), ( _1:08; _2:07; _3:04 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:1; Ts:( ( _1:08; _2:07; _3:02 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:3; Ts:( ( _1:05; _2:08; _3:02 ), ( _1:05; _2:11; _3:08 ), ( _1:11; _2:10; _3:08 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:4; Ts:( ( _1:00; _2:04; _3:09 ), ( _1:08; _2:02; _3:11 ), ( _1:08; _2:11; _3:10 ), ( _1:11; _2:02; _3:05 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:4; Ts:( ( _1:06; _2:11; _3:10 ), ( _1:06; _2:02; _3:11 ), ( _1:06; _2:00; _3:02 ), ( _1:02; _2:05; _3:11 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:5; Ts:( ( _1:11; _2:10; _3:02 ), ( _1:11; _2:02; _3:05 ), ( _1:10; _2:06; _3:02 ), ( _1:09; _2:02; _3:04 ), ( _1:06; _2:04; _3:02 ) ) ),
        ( TsN:4; Ts:( ( _1:02; _2:10; _3:08 ), ( _1:02; _2:04; _3:10 ), ( _1:02; _2:05; _3:04 ), ( _1:01; _2:10; _3:04 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:5; Ts:( ( _1:00; _2:01; _3:05 ), ( _1:00; _2:05; _3:09 ), ( _1:01; _2:10; _3:05 ), ( _1:02; _2:05; _3:08 ), ( _1:10; _2:08; _3:05 ) ) ),
        ( TsN:5; Ts:( ( _1:00; _2:02; _3:10 ), ( _1:00; _2:10; _3:06 ), ( _1:02; _2:05; _3:10 ), ( _1:01; _2:10; _3:04 ), ( _1:05; _2:04; _3:10 ) ) ),
        ( TsN:2; Ts:( ( _1:06; _2:01; _3:10 ), ( _1:02; _2:05; _3:09 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:4; Ts:( ( _1:01; _2:05; _3:11 ), ( _1:06; _2:05; _3:01 ), ( _1:06; _2:02; _3:05 ), ( _1:06; _2:08; _3:02 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:5; Ts:( ( _1:06; _2:11; _3:01 ), ( _1:06; _2:05; _3:11 ), ( _1:06; _2:08; _3:05 ), ( _1:02; _2:05; _3:08 ), ( _1:00; _2:04; _3:09 ) ) ),
        ( TsN:3; Ts:( ( _1:05; _2:11; _3:01 ), ( _1:05; _2:01; _3:02 ), ( _1:02; _2:01; _3:00 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:4; Ts:( ( _1:05; _2:11; _3:01 ), ( _1:05; _2:01; _3:02 ), ( _1:04; _2:09; _3:01 ), ( _1:09; _2:02; _3:01 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:3; Ts:( ( _1:08; _2:02; _3:05 ), ( _1:08; _2:05; _3:06 ), ( _1:06; _2:05; _3:04 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:4; Ts:( ( _1:09; _2:00; _3:06 ), ( _1:09; _2:06; _3:05 ), ( _1:08; _2:02; _3:06 ), ( _1:02; _2:05; _3:06 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:2; Ts:( ( _1:00; _2:02; _3:05 ), ( _1:04; _2:00; _3:05 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:1; Ts:( ( _1:09; _2:02; _3:05 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:2; Ts:( ( _1:08; _2:09; _3:10 ), ( _1:09; _2:11; _3:10 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:3; Ts:( ( _1:00; _2:04; _3:11 ), ( _1:00; _2:11; _3:08 ), ( _1:08; _2:11; _3:10 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:3; Ts:( ( _1:06; _2:00; _3:09 ), ( _1:06; _2:09; _3:10 ), ( _1:10; _2:09; _3:11 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:2; Ts:( ( _1:06; _2:04; _3:11 ), ( _1:10; _2:06; _3:11 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:3; Ts:( ( _1:04; _2:01; _3:10 ), ( _1:04; _2:10; _3:09 ), ( _1:09; _2:10; _3:08 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:2; Ts:( ( _1:00; _2:01; _3:10 ), ( _1:08; _2:00; _3:10 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:4; Ts:( ( _1:04; _2:01; _3:10 ), ( _1:04; _2:10; _3:09 ), ( _1:06; _2:00; _3:10 ), ( _1:00; _2:09; _3:10 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:1; Ts:( ( _1:06; _2:01; _3:10 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:3; Ts:( ( _1:01; _2:06; _3:08 ), ( _1:01; _2:08; _3:11 ), ( _1:11; _2:08; _3:09 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:4; Ts:( ( _1:01; _2:06; _3:08 ), ( _1:01; _2:08; _3:11 ), ( _1:00; _2:04; _3:08 ), ( _1:04; _2:11; _3:08 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:2; Ts:( ( _1:01; _2:00; _3:09 ), ( _1:11; _2:01; _3:09 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:1; Ts:( ( _1:01; _2:04; _3:11 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:2; Ts:( ( _1:08; _2:09; _3:04 ), ( _1:06; _2:08; _3:04 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:1; Ts:( ( _1:00; _2:06; _3:08 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:1; Ts:( ( _1:00; _2:09; _3:04 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:0; Ts:( ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) )
      );

//var //$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$【変数】

//$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$【ルーチン】

implementation //############################################################### ■

uses System.SysUtils, System.RTLConsts;

//$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$【レコード】

//$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$【クラス】

//%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% TIterMarcube

//&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&& private

//&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&& protected

/////////////////////////////////////////////////////////////////////// アクセス

function TIterMarcube.GetKind :Byte;
begin
     Result := 0;

     if Grids[0,0,0] < 0 then Result := Result or $01;
     if Grids[1,0,0] < 0 then Result := Result or $02;
     if Grids[0,1,0] < 0 then Result := Result or $04;
     if Grids[1,1,0] < 0 then Result := Result or $08;
     if Grids[0,0,1] < 0 then Result := Result or $10;
     if Grids[1,0,1] < 0 then Result := Result or $20;
     if Grids[0,1,1] < 0 then Result := Result or $40;
     if Grids[1,1,1] < 0 then Result := Result or $80;
end;

//&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&& public

//%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% TMarcubes

//&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&& private

//&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&& protected

/////////////////////////////////////////////////////////////////////// アクセス

/////////////////////////////////////////////////////////////////////// メソッド

procedure TMarcubes.Render;
begin
     Context.SetMatrix( TMatrix3D.CreateTranslation( TPoint3D.Create( -Grids.BricsX / 2,
                                                                      -Grids.BricsY / 2,
                                                                      -Grids.BricsZ / 2 ) )
                      * TMatrix3D.CreateScaling( TPoint3D.Create( Width  / Grids.BricsX,
                                                                  Height / Grids.BricsY,
                                                                  Depth  / Grids.BricsZ ) )
                      * AbsoluteMatrix );

     Context.DrawTriangles( _Geometry.VertexBuffer,
                            _Geometry.IndexBuffer,
                            TMaterialSource.ValidMaterial( _Material ),
                            AbsoluteOpacity );
end;

//------------------------------------------------------------------------------

procedure TMarcubes.MakeModel;
var
   EsX, EsY, EsZ :TDictionary<TInteger3D,Integer>;
   Ps :TArray<TPoin>;
   C :TIterMarcube;
//······································
     function AddPoin( const X_,Y_,Z_:Single ) :Integer;
     var
        P :TPoin;
     begin
          with P do
          begin
               Pos := TPoint3D.Create( X_, Y_, Z_ );
               Nor := TPoint3D.Create( C.Interp( Pos.X+1, Pos.Y, Pos.Z ) - C.Interp( Pos.X-1, Pos.Y, Pos.Z ),
                                       C.Interp( Pos.X, Pos.Y+1, Pos.Z ) - C.Interp( Pos.X, Pos.Y-1, Pos.Z ),
                                       C.Interp( Pos.X, Pos.Y, Pos.Z+1 ) - C.Interp( Pos.X, Pos.Y, Pos.Z-1 ) ).Normalize;
          end;

          Ps := Ps + [ P ];

          Result := High( Ps );
     end;
     //·································
     function FindPoin( const I_:Byte ) :Integer;
     begin
          with C do
          begin
               case I_ of
                00: Result := EsX[ TInteger3D.Create( GX[0], GY[0], GZ[0] ) ];
                01: Result := EsX[ TInteger3D.Create( GX[0], GY[1], GZ[0] ) ];
                02: Result := EsX[ TInteger3D.Create( GX[0], GY[0], GZ[1] ) ];
                03: Result := EsX[ TInteger3D.Create( GX[0], GY[1], GZ[1] ) ];

                04: Result := EsY[ TInteger3D.Create( GX[0], GY[0], GZ[0] ) ];
                05: Result := EsY[ TInteger3D.Create( GX[0], GY[0], GZ[1] ) ];
                06: Result := EsY[ TInteger3D.Create( GX[1], GY[0], GZ[0] ) ];
                07: Result := EsY[ TInteger3D.Create( GX[1], GY[0], GZ[1] ) ];

                08: Result := EsZ[ TInteger3D.Create( GX[1], GY[0], GZ[0] ) ];
                09: Result := EsZ[ TInteger3D.Create( GX[0], GY[0], GZ[0] ) ];
                10: Result := EsZ[ TInteger3D.Create( GX[1], GY[1], GZ[0] ) ];
                11: Result := EsZ[ TInteger3D.Create( GX[0], GY[1], GZ[0] ) ];

               else Result := -1;
               end;
          end;
     end;
//······································
var
   X, Y, Z, X0, X1, Y0, Y1, Z0, Z1, PsN, FsN, I, J :Integer;
   G0, G1, T :Single;
   Fs :TArray<TInteger3D>;
   F :TInteger3D;
begin
     //          200---------201---------202
     //          /|          /|          /|
     //         / |         / |         / |
     //        /  |        /  |        /  |
     //      100---------101---------102  |
     //      /|   |      /|   |      /|   |
     //     / |  210----/-|--211----/-|--212
     //    /  |  /|    /  |  /|    /  |  /|
     //  000---------001---------002  | / |
     //   |   |/  |   |   |/  |   |   |/  |
     //   |  110------|--111------|--112  |
     //   |  /|   |   |  /|   |   |  /|   |
     //   | / |  220--|-/-|--221--|-/-|--222
     //   |/  |  /    |/  |  /    |/  |  /
     //  010---------011---------012  | /
     //   |   |/      |   |/      |   |/
     //   |  120------|--121------|--122
     //   |  /        |  /        |  /
     //   | /         | /         | /
     //   |/          |/          |/
     //  020---------021---------022

     C := TIterMarcube.Create( _Grids );

     EsX := TDictionary<TInteger3D,Integer>.Create;
     EsY := TDictionary<TInteger3D,Integer>.Create;
     EsZ := TDictionary<TInteger3D,Integer>.Create;

     ////////// 頂点生成

     Ps := [];

     for Z := 0 to Grids.BricsZ do
     for Y := 0 to Grids.BricsY do
     begin
          X0 := 0;
          G0 := Grids[ X0, Y, Z ];
          for X1 := 1 to Grids.BricsX do
          begin
               G1 := Grids[ X1, Y, Z ];

               if ( G0 < 0 ) xor ( G1 < 0 ) then
               begin
                    T := G0 / ( G0 - G1 );

                    EsX.Add( TInteger3D.Create( X0, Y, Z ), AddPoin( X0 + T, Y, Z ) );
               end;

               X0 := X1;
               G0 := G1;
          end;
     end;

     for X := 0 to Grids.BricsX do
     for Z := 0 to Grids.BricsZ do
     begin
          Y0 := 0;
          G0 := Grids[ X, Y0, Z ];
          for Y1 := 1 to Grids.BricsY do
          begin
               G1 := Grids[ X, Y1, Z ];

               if ( G0 < 0 ) xor ( G1 < 0 ) then
               begin
                    T := G0 / ( G0 - G1 );

                    EsY.Add( TInteger3D.Create( X, Y0, Z ), AddPoin( X, Y0 + T, Z ) );
               end;

               Y0 := Y1;
               G0 := G1;
          end;
     end;

     for Y := 0 to Grids.BricsY do
     for X := 0 to Grids.BricsX do
     begin
          Z0 := 0;
          G0 := Grids[ X, Y, Z0 ];
          for Z1 := 1 to Grids.BricsZ do
          begin
               G1 := Grids[ X, Y, Z1 ];

               if ( G0 < 0 ) xor ( G1 < 0 ) then
               begin
                    T := G0 / ( G0 - G1 );

                    EsZ.Add( TInteger3D.Create( X, Y, Z0 ), AddPoin( X, Y, Z0 + T ) );
               end;

               Z0 := Z1;
               G0 := G1;
          end;
     end;

     PsN := Length( Ps );

     ////////// 三角面生成

     Fs := [];


     C.PosZ := 0;
     for Z := 0 to Grids.BricsZ-1 do
     begin
          C.PosY := 0;
          for Y := 0 to Grids.BricsY-1 do
          begin
               C.PosX := 0;
               for X := 0 to Grids.BricsX-1 do
               begin
                    with TRIASTABLE[ C.Kind ] do
                    begin
                         for I := 1 to TsN do
                         begin
                              with Ts[ I ] do
                              begin
                                   F._1 := FindPoin( _1 );
                                   F._2 := FindPoin( _2 );
                                   F._3 := FindPoin( _3 );
                              end;

                              Fs := Fs + [ F ];
                         end;
                    end;
                    C.GoNextX;
               end;
               C.GoNextY;
          end;
          C.GoNextZ;
     end;

     FsN := Length( Fs );

     //////////

     EsX.DisposeOf;
     EsY.DisposeOf;
     EsZ.DisposeOf;

     C.DisposeOf;

     ////////// ポリゴン登録

     with _Geometry do
     begin
          with VertexBuffer do
          begin
               Length := PsN{Vert};

               for I := 0 to PsN-1 do
               begin
                    with Ps[ I ] do
                    begin
                         Vertices[ I ] := Pos;
                         Normals [ I ] := Nor;
                    end;
               end;
          end;

          with IndexBuffer do
          begin
               Length := FsN{Face} * 3{Vert/Face};

               J := 0;
               for I := 0 to FsN-1 do
               begin
                    Indices[ J ] := Fs[ I ]._3;  Inc( J );
                    Indices[ J ] := Fs[ I ]._2;  Inc( J );
                    Indices[ J ] := Fs[ I ]._1;  Inc( J );
               end;
          end;
     end;

     //////////

     Repaint;
end;

//&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&& public

constructor TMarcubes.Create( AOwner_:TComponent );
begin
     inherited;

     _Geometry := TMeshData.Create;
     _Material := nil;
     _Grids    := TSingleGridArray3D.Create;

     with _Grids do
     begin
          BricsX := 10;
          BricsY := 10;
          BricsZ := 10;
     end;
end;

destructor TMarcubes.Destroy;
begin
     _Grids   .DisposeOf;
     _Geometry.DisposeOf;

     inherited;
end;

/////////////////////////////////////////////////////////////////////// メソッド

procedure TMarcubes.EndUpdate;
begin
     inherited;

     if FUpdating = 0 then MakeModel;
end;

//$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$【ルーチン】

//############################################################################## □

initialization //$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$ 初期化

finalization //$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$ 最終化

end. //######################################################################### ■

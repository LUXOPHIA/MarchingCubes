unit LUX.FMX.Marcubes;

interface //#################################################################### ■

uses System.Classes, System.Math.Vectors, System.Generics.Collections,
     FMX.Types3D, FMX.Controls3D, FMX.MaterialSources,
     LUX, LUX.D3, LUX.Data.Lattice.T3;

type //$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$【型】

     TMarcubes = class;

     //$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$【レコード】

     //%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% TVert

     TPoin = record
       Pos :TPoint3D;
       Nor :TPoint3D;
     end;

     //%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% TTrias

     TTrias = record
       TsN :Integer;
       Ts  :array[ 1..5 ] of TShortint3D;
     end;

     //$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$【クラス】

     //%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% TIterMarcube

     IIterMarcube = interface( IBricIterGridArray3D<Single> )
     ['{8FD59B4C-2D40-4262-A737-AD4FAC4B55E3}']
     {protected}
       ///// アクセス
       function GetKind :Byte;
     {public}
       ///// プロパティ
       property Kind :Byte read GetKind;
       ///// メソッド
       function FindPoin( const I_:Byte ) :Integer;
     end;

     //-------------------------------------------------------------------------

     TIterMarcube = class( TBricIterGridArray3D<Single>, IIterMarcube )
     private
     protected type
     protected
       _Parent :TMarcubes;
       ///// アクセス
       function GetKind :Byte;
     public
       constructor Create( Parent_:TMarcubes );
       ///// プロパティ
       property Kind :Byte read GetKind;
       ///// メソッド
       function FindPoin( const I_:Byte ) :Integer;
     end;

     //%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% TMarcubes

     TMarcubes = class( TControl3D )
     private
       EsX, EsY, EsZ :TDictionary<TInteger3D,Integer>;
     protected
       _Geometry :TMeshData;
       _Material :TMaterialSource;
       _Grids    :TGridArray3D<Single>;
       _Cube     :IIterMarcube;
       ///// アクセス
       ///// メソッド
       procedure Render; override;
     public
       constructor Create( AOwner_:TComponent ); override;
       destructor Destroy; override;
       ///// プロパティ
       property Material :TMaterialSource      read _Material write _Material;
       property Grids    :TGridArray3D<Single> read _Grids;
       ///// メソッド
       procedure EndUpdate; override;
       procedure MakeModel;
     end;

const //$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$【定数】

      TRIASTABLE :array[ 0..255 ] of TTrias = (
        ( TsN:0; Ts:( ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:1; Ts:( ( _1:00; _2:08; _3:03 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:1; Ts:( ( _1:00; _2:01; _3:09 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:2; Ts:( ( _1:01; _2:08; _3:03 ), ( _1:09; _2:08; _3:01 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:1; Ts:( ( _1:04; _2:07; _3:08 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:2; Ts:( ( _1:04; _2:03; _3:00 ), ( _1:07; _2:03; _3:04 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:2; Ts:( ( _1:00; _2:01; _3:09 ), ( _1:08; _2:04; _3:07 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:3; Ts:( ( _1:04; _2:01; _3:09 ), ( _1:04; _2:07; _3:01 ), ( _1:07; _2:03; _3:01 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:1; Ts:( ( _1:09; _2:05; _3:04 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:2; Ts:( ( _1:09; _2:05; _3:04 ), ( _1:00; _2:08; _3:03 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:2; Ts:( ( _1:00; _2:05; _3:04 ), ( _1:01; _2:05; _3:00 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:3; Ts:( ( _1:08; _2:05; _3:04 ), ( _1:08; _2:03; _3:05 ), ( _1:03; _2:01; _3:05 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:2; Ts:( ( _1:09; _2:07; _3:08 ), ( _1:05; _2:07; _3:09 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:3; Ts:( ( _1:09; _2:03; _3:00 ), ( _1:09; _2:05; _3:03 ), ( _1:05; _2:07; _3:03 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:3; Ts:( ( _1:00; _2:07; _3:08 ), ( _1:00; _2:01; _3:07 ), ( _1:01; _2:05; _3:07 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:2; Ts:( ( _1:01; _2:05; _3:03 ), ( _1:03; _2:05; _3:07 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:1; Ts:( ( _1:03; _2:11; _3:02 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:2; Ts:( ( _1:00; _2:11; _3:02 ), ( _1:08; _2:11; _3:00 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:2; Ts:( ( _1:01; _2:09; _3:00 ), ( _1:02; _2:03; _3:11 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:3; Ts:( ( _1:01; _2:11; _3:02 ), ( _1:01; _2:09; _3:11 ), ( _1:09; _2:08; _3:11 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:2; Ts:( ( _1:08; _2:04; _3:07 ), ( _1:03; _2:11; _3:02 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:3; Ts:( ( _1:11; _2:04; _3:07 ), ( _1:11; _2:02; _3:04 ), ( _1:02; _2:00; _3:04 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:3; Ts:( ( _1:09; _2:00; _3:01 ), ( _1:08; _2:04; _3:07 ), ( _1:02; _2:03; _3:11 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:4; Ts:( ( _1:04; _2:07; _3:11 ), ( _1:09; _2:04; _3:11 ), ( _1:09; _2:11; _3:02 ), ( _1:09; _2:02; _3:01 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:2; Ts:( ( _1:09; _2:05; _3:04 ), ( _1:02; _2:03; _3:11 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:3; Ts:( ( _1:00; _2:11; _3:02 ), ( _1:00; _2:08; _3:11 ), ( _1:04; _2:09; _3:05 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:3; Ts:( ( _1:00; _2:05; _3:04 ), ( _1:00; _2:01; _3:05 ), ( _1:02; _2:03; _3:11 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:4; Ts:( ( _1:02; _2:01; _3:05 ), ( _1:02; _2:05; _3:08 ), ( _1:02; _2:08; _3:11 ), ( _1:04; _2:08; _3:05 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:3; Ts:( ( _1:07; _2:09; _3:05 ), ( _1:07; _2:08; _3:09 ), ( _1:03; _2:11; _3:02 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:4; Ts:( ( _1:09; _2:05; _3:07 ), ( _1:09; _2:07; _3:02 ), ( _1:09; _2:02; _3:00 ), ( _1:02; _2:07; _3:11 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:4; Ts:( ( _1:02; _2:03; _3:11 ), ( _1:00; _2:01; _3:08 ), ( _1:01; _2:07; _3:08 ), ( _1:01; _2:05; _3:07 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:3; Ts:( ( _1:11; _2:02; _3:01 ), ( _1:11; _2:01; _3:07 ), ( _1:07; _2:01; _3:05 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:1; Ts:( ( _1:01; _2:02; _3:10 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:2; Ts:( ( _1:00; _2:08; _3:03 ), ( _1:01; _2:02; _3:10 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:2; Ts:( ( _1:09; _2:02; _3:10 ), ( _1:00; _2:02; _3:09 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:3; Ts:( ( _1:02; _2:08; _3:03 ), ( _1:02; _2:10; _3:08 ), ( _1:10; _2:09; _3:08 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:2; Ts:( ( _1:01; _2:02; _3:10 ), ( _1:08; _2:04; _3:07 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:3; Ts:( ( _1:03; _2:04; _3:07 ), ( _1:03; _2:00; _3:04 ), ( _1:01; _2:02; _3:10 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:3; Ts:( ( _1:09; _2:02; _3:10 ), ( _1:09; _2:00; _3:02 ), ( _1:08; _2:04; _3:07 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:4; Ts:( ( _1:02; _2:10; _3:09 ), ( _1:02; _2:09; _3:07 ), ( _1:02; _2:07; _3:03 ), ( _1:07; _2:09; _3:04 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:2; Ts:( ( _1:01; _2:02; _3:10 ), ( _1:09; _2:05; _3:04 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:3; Ts:( ( _1:03; _2:00; _3:08 ), ( _1:01; _2:02; _3:10 ), ( _1:04; _2:09; _3:05 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:3; Ts:( ( _1:05; _2:02; _3:10 ), ( _1:05; _2:04; _3:02 ), ( _1:04; _2:00; _3:02 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:4; Ts:( ( _1:02; _2:10; _3:05 ), ( _1:03; _2:02; _3:05 ), ( _1:03; _2:05; _3:04 ), ( _1:03; _2:04; _3:08 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:3; Ts:( ( _1:09; _2:07; _3:08 ), ( _1:09; _2:05; _3:07 ), ( _1:10; _2:01; _3:02 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:4; Ts:( ( _1:10; _2:01; _3:02 ), ( _1:09; _2:05; _3:00 ), ( _1:05; _2:03; _3:00 ), ( _1:05; _2:07; _3:03 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:4; Ts:( ( _1:08; _2:00; _3:02 ), ( _1:08; _2:02; _3:05 ), ( _1:08; _2:05; _3:07 ), ( _1:10; _2:05; _3:02 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:3; Ts:( ( _1:02; _2:10; _3:05 ), ( _1:02; _2:05; _3:03 ), ( _1:03; _2:05; _3:07 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:2; Ts:( ( _1:03; _2:10; _3:01 ), ( _1:11; _2:10; _3:03 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:3; Ts:( ( _1:00; _2:10; _3:01 ), ( _1:00; _2:08; _3:10 ), ( _1:08; _2:11; _3:10 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:3; Ts:( ( _1:03; _2:09; _3:00 ), ( _1:03; _2:11; _3:09 ), ( _1:11; _2:10; _3:09 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:2; Ts:( ( _1:09; _2:08; _3:10 ), ( _1:10; _2:08; _3:11 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:3; Ts:( ( _1:03; _2:10; _3:01 ), ( _1:03; _2:11; _3:10 ), ( _1:07; _2:08; _3:04 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:4; Ts:( ( _1:01; _2:11; _3:10 ), ( _1:01; _2:04; _3:11 ), ( _1:01; _2:00; _3:04 ), ( _1:07; _2:11; _3:04 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:4; Ts:( ( _1:04; _2:07; _3:08 ), ( _1:09; _2:00; _3:11 ), ( _1:09; _2:11; _3:10 ), ( _1:11; _2:00; _3:03 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:3; Ts:( ( _1:04; _2:07; _3:11 ), ( _1:04; _2:11; _3:09 ), ( _1:09; _2:11; _3:10 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:3; Ts:( ( _1:10; _2:03; _3:11 ), ( _1:10; _2:01; _3:03 ), ( _1:09; _2:05; _3:04 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:4; Ts:( ( _1:04; _2:09; _3:05 ), ( _1:00; _2:08; _3:01 ), ( _1:08; _2:10; _3:01 ), ( _1:08; _2:11; _3:10 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:4; Ts:( ( _1:05; _2:04; _3:00 ), ( _1:05; _2:00; _3:11 ), ( _1:05; _2:11; _3:10 ), ( _1:11; _2:00; _3:03 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:3; Ts:( ( _1:05; _2:04; _3:08 ), ( _1:05; _2:08; _3:10 ), ( _1:10; _2:08; _3:11 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:4; Ts:( ( _1:09; _2:05; _3:08 ), ( _1:08; _2:05; _3:07 ), ( _1:10; _2:01; _3:03 ), ( _1:10; _2:03; _3:11 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:5; Ts:( ( _1:05; _2:07; _3:00 ), ( _1:05; _2:00; _3:09 ), ( _1:07; _2:11; _3:00 ), ( _1:01; _2:00; _3:10 ), ( _1:11; _2:10; _3:00 ) ) ),
        ( TsN:5; Ts:( ( _1:11; _2:10; _3:00 ), ( _1:11; _2:00; _3:03 ), ( _1:10; _2:05; _3:00 ), ( _1:08; _2:00; _3:07 ), ( _1:05; _2:07; _3:00 ) ) ),
        ( TsN:2; Ts:( ( _1:11; _2:10; _3:05 ), ( _1:07; _2:11; _3:05 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:1; Ts:( ( _1:07; _2:06; _3:11 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:2; Ts:( ( _1:03; _2:00; _3:08 ), ( _1:11; _2:07; _3:06 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:2; Ts:( ( _1:00; _2:01; _3:09 ), ( _1:11; _2:07; _3:06 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:3; Ts:( ( _1:08; _2:01; _3:09 ), ( _1:08; _2:03; _3:01 ), ( _1:11; _2:07; _3:06 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:2; Ts:( ( _1:06; _2:08; _3:04 ), ( _1:11; _2:08; _3:06 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:3; Ts:( ( _1:03; _2:06; _3:11 ), ( _1:03; _2:00; _3:06 ), ( _1:00; _2:04; _3:06 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:3; Ts:( ( _1:08; _2:06; _3:11 ), ( _1:08; _2:04; _3:06 ), ( _1:09; _2:00; _3:01 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:4; Ts:( ( _1:09; _2:04; _3:06 ), ( _1:09; _2:06; _3:03 ), ( _1:09; _2:03; _3:01 ), ( _1:11; _2:03; _3:06 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:2; Ts:( ( _1:04; _2:09; _3:05 ), ( _1:07; _2:06; _3:11 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:3; Ts:( ( _1:00; _2:08; _3:03 ), ( _1:04; _2:09; _3:05 ), ( _1:11; _2:07; _3:06 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:3; Ts:( ( _1:05; _2:00; _3:01 ), ( _1:05; _2:04; _3:00 ), ( _1:07; _2:06; _3:11 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:4; Ts:( ( _1:11; _2:07; _3:06 ), ( _1:08; _2:03; _3:04 ), ( _1:03; _2:05; _3:04 ), ( _1:03; _2:01; _3:05 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:3; Ts:( ( _1:06; _2:09; _3:05 ), ( _1:06; _2:11; _3:09 ), ( _1:11; _2:08; _3:09 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:4; Ts:( ( _1:03; _2:06; _3:11 ), ( _1:00; _2:06; _3:03 ), ( _1:00; _2:05; _3:06 ), ( _1:00; _2:09; _3:05 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:4; Ts:( ( _1:00; _2:11; _3:08 ), ( _1:00; _2:05; _3:11 ), ( _1:00; _2:01; _3:05 ), ( _1:05; _2:06; _3:11 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:3; Ts:( ( _1:06; _2:11; _3:03 ), ( _1:06; _2:03; _3:05 ), ( _1:05; _2:03; _3:01 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:2; Ts:( ( _1:07; _2:02; _3:03 ), ( _1:06; _2:02; _3:07 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:3; Ts:( ( _1:07; _2:00; _3:08 ), ( _1:07; _2:06; _3:00 ), ( _1:06; _2:02; _3:00 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:3; Ts:( ( _1:02; _2:07; _3:06 ), ( _1:02; _2:03; _3:07 ), ( _1:00; _2:01; _3:09 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:4; Ts:( ( _1:01; _2:06; _3:02 ), ( _1:01; _2:08; _3:06 ), ( _1:01; _2:09; _3:08 ), ( _1:08; _2:07; _3:06 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:3; Ts:( ( _1:08; _2:02; _3:03 ), ( _1:08; _2:04; _3:02 ), ( _1:04; _2:06; _3:02 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:2; Ts:( ( _1:00; _2:04; _3:02 ), ( _1:04; _2:06; _3:02 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:4; Ts:( ( _1:01; _2:09; _3:00 ), ( _1:02; _2:03; _3:04 ), ( _1:02; _2:04; _3:06 ), ( _1:04; _2:03; _3:08 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:3; Ts:( ( _1:01; _2:09; _3:04 ), ( _1:01; _2:04; _3:02 ), ( _1:02; _2:04; _3:06 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:3; Ts:( ( _1:07; _2:02; _3:03 ), ( _1:07; _2:06; _3:02 ), ( _1:05; _2:04; _3:09 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:4; Ts:( ( _1:09; _2:05; _3:04 ), ( _1:00; _2:08; _3:06 ), ( _1:00; _2:06; _3:02 ), ( _1:06; _2:08; _3:07 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:4; Ts:( ( _1:03; _2:06; _3:02 ), ( _1:03; _2:07; _3:06 ), ( _1:01; _2:05; _3:00 ), ( _1:05; _2:04; _3:00 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:5; Ts:( ( _1:06; _2:02; _3:08 ), ( _1:06; _2:08; _3:07 ), ( _1:02; _2:01; _3:08 ), ( _1:04; _2:08; _3:05 ), ( _1:01; _2:05; _3:08 ) ) ),
        ( TsN:4; Ts:( ( _1:05; _2:08; _3:09 ), ( _1:05; _2:02; _3:08 ), ( _1:05; _2:06; _3:02 ), ( _1:03; _2:08; _3:02 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:3; Ts:( ( _1:09; _2:05; _3:06 ), ( _1:09; _2:06; _3:00 ), ( _1:00; _2:06; _3:02 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:5; Ts:( ( _1:01; _2:05; _3:08 ), ( _1:01; _2:08; _3:00 ), ( _1:05; _2:06; _3:08 ), ( _1:03; _2:08; _3:02 ), ( _1:06; _2:02; _3:08 ) ) ),
        ( TsN:2; Ts:( ( _1:01; _2:05; _3:06 ), ( _1:02; _2:01; _3:06 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:2; Ts:( ( _1:10; _2:01; _3:02 ), ( _1:06; _2:11; _3:07 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:3; Ts:( ( _1:01; _2:02; _3:10 ), ( _1:03; _2:00; _3:08 ), ( _1:06; _2:11; _3:07 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:3; Ts:( ( _1:02; _2:09; _3:00 ), ( _1:02; _2:10; _3:09 ), ( _1:06; _2:11; _3:07 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:4; Ts:( ( _1:06; _2:11; _3:07 ), ( _1:02; _2:10; _3:03 ), ( _1:10; _2:08; _3:03 ), ( _1:10; _2:09; _3:08 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:3; Ts:( ( _1:06; _2:08; _3:04 ), ( _1:06; _2:11; _3:08 ), ( _1:02; _2:10; _3:01 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:4; Ts:( ( _1:01; _2:02; _3:10 ), ( _1:03; _2:00; _3:11 ), ( _1:00; _2:06; _3:11 ), ( _1:00; _2:04; _3:06 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:4; Ts:( ( _1:04; _2:11; _3:08 ), ( _1:04; _2:06; _3:11 ), ( _1:00; _2:02; _3:09 ), ( _1:02; _2:10; _3:09 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:5; Ts:( ( _1:10; _2:09; _3:03 ), ( _1:10; _2:03; _3:02 ), ( _1:09; _2:04; _3:03 ), ( _1:11; _2:03; _3:06 ), ( _1:04; _2:06; _3:03 ) ) ),
        ( TsN:3; Ts:( ( _1:09; _2:05; _3:04 ), ( _1:10; _2:01; _3:02 ), ( _1:07; _2:06; _3:11 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:4; Ts:( ( _1:06; _2:11; _3:07 ), ( _1:01; _2:02; _3:10 ), ( _1:00; _2:08; _3:03 ), ( _1:04; _2:09; _3:05 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:4; Ts:( ( _1:07; _2:06; _3:11 ), ( _1:05; _2:04; _3:10 ), ( _1:04; _2:02; _3:10 ), ( _1:04; _2:00; _3:02 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:5; Ts:( ( _1:03; _2:04; _3:08 ), ( _1:03; _2:05; _3:04 ), ( _1:03; _2:02; _3:05 ), ( _1:10; _2:05; _3:02 ), ( _1:11; _2:07; _3:06 ) ) ),
        ( TsN:4; Ts:( ( _1:01; _2:02; _3:10 ), ( _1:09; _2:05; _3:11 ), ( _1:09; _2:11; _3:08 ), ( _1:11; _2:05; _3:06 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:5; Ts:( ( _1:00; _2:11; _3:03 ), ( _1:00; _2:06; _3:11 ), ( _1:00; _2:09; _3:06 ), ( _1:05; _2:06; _3:09 ), ( _1:01; _2:02; _3:10 ) ) ),
        ( TsN:5; Ts:( ( _1:11; _2:08; _3:05 ), ( _1:11; _2:05; _3:06 ), ( _1:08; _2:00; _3:05 ), ( _1:10; _2:05; _3:02 ), ( _1:00; _2:02; _3:05 ) ) ),
        ( TsN:4; Ts:( ( _1:06; _2:11; _3:03 ), ( _1:06; _2:03; _3:05 ), ( _1:02; _2:10; _3:03 ), ( _1:10; _2:05; _3:03 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:3; Ts:( ( _1:10; _2:07; _3:06 ), ( _1:10; _2:01; _3:07 ), ( _1:01; _2:03; _3:07 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:4; Ts:( ( _1:10; _2:07; _3:06 ), ( _1:01; _2:07; _3:10 ), ( _1:01; _2:08; _3:07 ), ( _1:01; _2:00; _3:08 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:4; Ts:( ( _1:00; _2:03; _3:07 ), ( _1:00; _2:07; _3:10 ), ( _1:00; _2:10; _3:09 ), ( _1:06; _2:10; _3:07 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:3; Ts:( ( _1:07; _2:06; _3:10 ), ( _1:07; _2:10; _3:08 ), ( _1:08; _2:10; _3:09 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:4; Ts:( ( _1:08; _2:01; _3:03 ), ( _1:08; _2:06; _3:01 ), ( _1:08; _2:04; _3:06 ), ( _1:06; _2:10; _3:01 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:3; Ts:( ( _1:10; _2:01; _3:00 ), ( _1:10; _2:00; _3:06 ), ( _1:06; _2:00; _3:04 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:5; Ts:( ( _1:04; _2:06; _3:03 ), ( _1:04; _2:03; _3:08 ), ( _1:06; _2:10; _3:03 ), ( _1:00; _2:03; _3:09 ), ( _1:10; _2:09; _3:03 ) ) ),
        ( TsN:2; Ts:( ( _1:10; _2:09; _3:04 ), ( _1:06; _2:10; _3:04 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:4; Ts:( ( _1:09; _2:05; _3:04 ), ( _1:10; _2:01; _3:06 ), ( _1:01; _2:07; _3:06 ), ( _1:01; _2:03; _3:07 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:5; Ts:( ( _1:01; _2:06; _3:10 ), ( _1:01; _2:07; _3:06 ), ( _1:01; _2:00; _3:07 ), ( _1:08; _2:07; _3:00 ), ( _1:09; _2:05; _3:04 ) ) ),
        ( TsN:5; Ts:( ( _1:04; _2:00; _3:10 ), ( _1:04; _2:10; _3:05 ), ( _1:00; _2:03; _3:10 ), ( _1:06; _2:10; _3:07 ), ( _1:03; _2:07; _3:10 ) ) ),
        ( TsN:4; Ts:( ( _1:07; _2:06; _3:10 ), ( _1:07; _2:10; _3:08 ), ( _1:05; _2:04; _3:10 ), ( _1:04; _2:08; _3:10 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:5; Ts:( ( _1:01; _2:03; _3:06 ), ( _1:01; _2:06; _3:10 ), ( _1:03; _2:08; _3:06 ), ( _1:05; _2:06; _3:09 ), ( _1:08; _2:09; _3:06 ) ) ),
        ( TsN:4; Ts:( ( _1:10; _2:01; _3:00 ), ( _1:10; _2:00; _3:06 ), ( _1:09; _2:05; _3:00 ), ( _1:05; _2:06; _3:00 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:2; Ts:( ( _1:00; _2:03; _3:08 ), ( _1:05; _2:06; _3:10 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:1; Ts:( ( _1:10; _2:05; _3:06 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:1; Ts:( ( _1:10; _2:06; _3:05 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:2; Ts:( ( _1:00; _2:08; _3:03 ), ( _1:05; _2:10; _3:06 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:2; Ts:( ( _1:09; _2:00; _3:01 ), ( _1:05; _2:10; _3:06 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:3; Ts:( ( _1:01; _2:08; _3:03 ), ( _1:01; _2:09; _3:08 ), ( _1:05; _2:10; _3:06 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:2; Ts:( ( _1:05; _2:10; _3:06 ), ( _1:04; _2:07; _3:08 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:3; Ts:( ( _1:04; _2:03; _3:00 ), ( _1:04; _2:07; _3:03 ), ( _1:06; _2:05; _3:10 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:3; Ts:( ( _1:01; _2:09; _3:00 ), ( _1:05; _2:10; _3:06 ), ( _1:08; _2:04; _3:07 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:4; Ts:( ( _1:10; _2:06; _3:05 ), ( _1:01; _2:09; _3:07 ), ( _1:01; _2:07; _3:03 ), ( _1:07; _2:09; _3:04 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:2; Ts:( ( _1:10; _2:04; _3:09 ), ( _1:06; _2:04; _3:10 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:3; Ts:( ( _1:04; _2:10; _3:06 ), ( _1:04; _2:09; _3:10 ), ( _1:00; _2:08; _3:03 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:3; Ts:( ( _1:10; _2:00; _3:01 ), ( _1:10; _2:06; _3:00 ), ( _1:06; _2:04; _3:00 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:4; Ts:( ( _1:08; _2:03; _3:01 ), ( _1:08; _2:01; _3:06 ), ( _1:08; _2:06; _3:04 ), ( _1:06; _2:01; _3:10 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:3; Ts:( ( _1:07; _2:10; _3:06 ), ( _1:07; _2:08; _3:10 ), ( _1:08; _2:09; _3:10 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:4; Ts:( ( _1:00; _2:07; _3:03 ), ( _1:00; _2:10; _3:07 ), ( _1:00; _2:09; _3:10 ), ( _1:06; _2:07; _3:10 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:4; Ts:( ( _1:10; _2:06; _3:07 ), ( _1:01; _2:10; _3:07 ), ( _1:01; _2:07; _3:08 ), ( _1:01; _2:08; _3:00 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:3; Ts:( ( _1:10; _2:06; _3:07 ), ( _1:10; _2:07; _3:01 ), ( _1:01; _2:07; _3:03 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:2; Ts:( ( _1:02; _2:03; _3:11 ), ( _1:10; _2:06; _3:05 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:3; Ts:( ( _1:11; _2:00; _3:08 ), ( _1:11; _2:02; _3:00 ), ( _1:10; _2:06; _3:05 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:3; Ts:( ( _1:00; _2:01; _3:09 ), ( _1:02; _2:03; _3:11 ), ( _1:05; _2:10; _3:06 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:4; Ts:( ( _1:05; _2:10; _3:06 ), ( _1:01; _2:09; _3:02 ), ( _1:09; _2:11; _3:02 ), ( _1:09; _2:08; _3:11 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:3; Ts:( ( _1:03; _2:11; _3:02 ), ( _1:07; _2:08; _3:04 ), ( _1:10; _2:06; _3:05 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:4; Ts:( ( _1:05; _2:10; _3:06 ), ( _1:04; _2:07; _3:02 ), ( _1:04; _2:02; _3:00 ), ( _1:02; _2:07; _3:11 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:4; Ts:( ( _1:00; _2:01; _3:09 ), ( _1:04; _2:07; _3:08 ), ( _1:02; _2:03; _3:11 ), ( _1:05; _2:10; _3:06 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:5; Ts:( ( _1:09; _2:02; _3:01 ), ( _1:09; _2:11; _3:02 ), ( _1:09; _2:04; _3:11 ), ( _1:07; _2:11; _3:04 ), ( _1:05; _2:10; _3:06 ) ) ),
        ( TsN:3; Ts:( ( _1:10; _2:04; _3:09 ), ( _1:10; _2:06; _3:04 ), ( _1:11; _2:02; _3:03 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:4; Ts:( ( _1:00; _2:08; _3:02 ), ( _1:02; _2:08; _3:11 ), ( _1:04; _2:09; _3:10 ), ( _1:04; _2:10; _3:06 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:4; Ts:( ( _1:03; _2:11; _3:02 ), ( _1:00; _2:01; _3:06 ), ( _1:00; _2:06; _3:04 ), ( _1:06; _2:01; _3:10 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:5; Ts:( ( _1:06; _2:04; _3:01 ), ( _1:06; _2:01; _3:10 ), ( _1:04; _2:08; _3:01 ), ( _1:02; _2:01; _3:11 ), ( _1:08; _2:11; _3:01 ) ) ),
        ( TsN:4; Ts:( ( _1:02; _2:03; _3:11 ), ( _1:10; _2:06; _3:08 ), ( _1:10; _2:08; _3:09 ), ( _1:08; _2:06; _3:07 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:5; Ts:( ( _1:02; _2:00; _3:07 ), ( _1:02; _2:07; _3:11 ), ( _1:00; _2:09; _3:07 ), ( _1:06; _2:07; _3:10 ), ( _1:09; _2:10; _3:07 ) ) ),
        ( TsN:5; Ts:( ( _1:01; _2:08; _3:00 ), ( _1:01; _2:07; _3:08 ), ( _1:01; _2:10; _3:07 ), ( _1:06; _2:07; _3:10 ), ( _1:02; _2:03; _3:11 ) ) ),
        ( TsN:4; Ts:( ( _1:11; _2:02; _3:01 ), ( _1:11; _2:01; _3:07 ), ( _1:10; _2:06; _3:01 ), ( _1:06; _2:07; _3:01 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:2; Ts:( ( _1:01; _2:06; _3:05 ), ( _1:02; _2:06; _3:01 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:3; Ts:( ( _1:01; _2:06; _3:05 ), ( _1:01; _2:02; _3:06 ), ( _1:03; _2:00; _3:08 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:3; Ts:( ( _1:09; _2:06; _3:05 ), ( _1:09; _2:00; _3:06 ), ( _1:00; _2:02; _3:06 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:4; Ts:( ( _1:05; _2:09; _3:08 ), ( _1:05; _2:08; _3:02 ), ( _1:05; _2:02; _3:06 ), ( _1:03; _2:02; _3:08 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:3; Ts:( ( _1:06; _2:01; _3:02 ), ( _1:06; _2:05; _3:01 ), ( _1:04; _2:07; _3:08 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:4; Ts:( ( _1:01; _2:02; _3:05 ), ( _1:05; _2:02; _3:06 ), ( _1:03; _2:00; _3:04 ), ( _1:03; _2:04; _3:07 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:4; Ts:( ( _1:08; _2:04; _3:07 ), ( _1:09; _2:00; _3:05 ), ( _1:00; _2:06; _3:05 ), ( _1:00; _2:02; _3:06 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:5; Ts:( ( _1:07; _2:03; _3:09 ), ( _1:07; _2:09; _3:04 ), ( _1:03; _2:02; _3:09 ), ( _1:05; _2:09; _3:06 ), ( _1:02; _2:06; _3:09 ) ) ),
        ( TsN:3; Ts:( ( _1:01; _2:04; _3:09 ), ( _1:01; _2:02; _3:04 ), ( _1:02; _2:06; _3:04 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:4; Ts:( ( _1:03; _2:00; _3:08 ), ( _1:01; _2:02; _3:09 ), ( _1:02; _2:04; _3:09 ), ( _1:02; _2:06; _3:04 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:2; Ts:( ( _1:00; _2:02; _3:04 ), ( _1:04; _2:02; _3:06 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:3; Ts:( ( _1:08; _2:03; _3:02 ), ( _1:08; _2:02; _3:04 ), ( _1:04; _2:02; _3:06 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:4; Ts:( ( _1:01; _2:02; _3:06 ), ( _1:01; _2:06; _3:08 ), ( _1:01; _2:08; _3:09 ), ( _1:08; _2:06; _3:07 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:5; Ts:( ( _1:02; _2:06; _3:09 ), ( _1:02; _2:09; _3:01 ), ( _1:06; _2:07; _3:09 ), ( _1:00; _2:09; _3:03 ), ( _1:07; _2:03; _3:09 ) ) ),
        ( TsN:3; Ts:( ( _1:07; _2:08; _3:00 ), ( _1:07; _2:00; _3:06 ), ( _1:06; _2:00; _3:02 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:2; Ts:( ( _1:07; _2:03; _3:02 ), ( _1:06; _2:07; _3:02 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:3; Ts:( ( _1:06; _2:03; _3:11 ), ( _1:06; _2:05; _3:03 ), ( _1:05; _2:01; _3:03 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:4; Ts:( ( _1:00; _2:08; _3:11 ), ( _1:00; _2:11; _3:05 ), ( _1:00; _2:05; _3:01 ), ( _1:05; _2:11; _3:06 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:4; Ts:( ( _1:03; _2:11; _3:06 ), ( _1:00; _2:03; _3:06 ), ( _1:00; _2:06; _3:05 ), ( _1:00; _2:05; _3:09 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:3; Ts:( ( _1:06; _2:05; _3:09 ), ( _1:06; _2:09; _3:11 ), ( _1:11; _2:09; _3:08 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:4; Ts:( ( _1:08; _2:04; _3:07 ), ( _1:03; _2:11; _3:05 ), ( _1:03; _2:05; _3:01 ), ( _1:05; _2:11; _3:06 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:5; Ts:( ( _1:05; _2:01; _3:11 ), ( _1:05; _2:11; _3:06 ), ( _1:01; _2:00; _3:11 ), ( _1:07; _2:11; _3:04 ), ( _1:00; _2:04; _3:11 ) ) ),
        ( TsN:5; Ts:( ( _1:00; _2:05; _3:09 ), ( _1:00; _2:06; _3:05 ), ( _1:00; _2:03; _3:06 ), ( _1:11; _2:06; _3:03 ), ( _1:08; _2:04; _3:07 ) ) ),
        ( TsN:4; Ts:( ( _1:06; _2:05; _3:09 ), ( _1:06; _2:09; _3:11 ), ( _1:04; _2:07; _3:09 ), ( _1:07; _2:11; _3:09 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:4; Ts:( ( _1:09; _2:06; _3:04 ), ( _1:09; _2:03; _3:06 ), ( _1:09; _2:01; _3:03 ), ( _1:11; _2:06; _3:03 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:5; Ts:( ( _1:08; _2:11; _3:01 ), ( _1:08; _2:01; _3:00 ), ( _1:11; _2:06; _3:01 ), ( _1:09; _2:01; _3:04 ), ( _1:06; _2:04; _3:01 ) ) ),
        ( TsN:3; Ts:( ( _1:03; _2:11; _3:06 ), ( _1:03; _2:06; _3:00 ), ( _1:00; _2:06; _3:04 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:2; Ts:( ( _1:06; _2:04; _3:08 ), ( _1:11; _2:06; _3:08 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:5; Ts:( ( _1:08; _2:09; _3:06 ), ( _1:08; _2:06; _3:07 ), ( _1:09; _2:01; _3:06 ), ( _1:11; _2:06; _3:03 ), ( _1:01; _2:03; _3:06 ) ) ),
        ( TsN:2; Ts:( ( _1:00; _2:09; _3:01 ), ( _1:11; _2:06; _3:07 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:4; Ts:( ( _1:07; _2:08; _3:00 ), ( _1:07; _2:00; _3:06 ), ( _1:03; _2:11; _3:00 ), ( _1:11; _2:06; _3:00 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:1; Ts:( ( _1:07; _2:11; _3:06 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:2; Ts:( ( _1:11; _2:05; _3:10 ), ( _1:07; _2:05; _3:11 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:3; Ts:( ( _1:11; _2:05; _3:10 ), ( _1:11; _2:07; _3:05 ), ( _1:08; _2:03; _3:00 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:3; Ts:( ( _1:05; _2:11; _3:07 ), ( _1:05; _2:10; _3:11 ), ( _1:01; _2:09; _3:00 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:4; Ts:( ( _1:10; _2:07; _3:05 ), ( _1:10; _2:11; _3:07 ), ( _1:09; _2:08; _3:01 ), ( _1:08; _2:03; _3:01 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:3; Ts:( ( _1:05; _2:08; _3:04 ), ( _1:05; _2:10; _3:08 ), ( _1:10; _2:11; _3:08 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:4; Ts:( ( _1:05; _2:00; _3:04 ), ( _1:05; _2:11; _3:00 ), ( _1:05; _2:10; _3:11 ), ( _1:11; _2:03; _3:00 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:4; Ts:( ( _1:00; _2:01; _3:09 ), ( _1:08; _2:04; _3:10 ), ( _1:08; _2:10; _3:11 ), ( _1:10; _2:04; _3:05 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:5; Ts:( ( _1:10; _2:11; _3:04 ), ( _1:10; _2:04; _3:05 ), ( _1:11; _2:03; _3:04 ), ( _1:09; _2:04; _3:01 ), ( _1:03; _2:01; _3:04 ) ) ),
        ( TsN:3; Ts:( ( _1:04; _2:11; _3:07 ), ( _1:04; _2:09; _3:11 ), ( _1:09; _2:10; _3:11 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:4; Ts:( ( _1:00; _2:08; _3:03 ), ( _1:04; _2:09; _3:07 ), ( _1:09; _2:11; _3:07 ), ( _1:09; _2:10; _3:11 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:4; Ts:( ( _1:01; _2:10; _3:11 ), ( _1:01; _2:11; _3:04 ), ( _1:01; _2:04; _3:00 ), ( _1:07; _2:04; _3:11 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:5; Ts:( ( _1:03; _2:01; _3:04 ), ( _1:03; _2:04; _3:08 ), ( _1:01; _2:10; _3:04 ), ( _1:07; _2:04; _3:11 ), ( _1:10; _2:11; _3:04 ) ) ),
        ( TsN:2; Ts:( ( _1:09; _2:10; _3:08 ), ( _1:10; _2:11; _3:08 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:3; Ts:( ( _1:03; _2:00; _3:09 ), ( _1:03; _2:09; _3:11 ), ( _1:11; _2:09; _3:10 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:3; Ts:( ( _1:00; _2:01; _3:10 ), ( _1:00; _2:10; _3:08 ), ( _1:08; _2:10; _3:11 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:2; Ts:( ( _1:03; _2:01; _3:10 ), ( _1:11; _2:03; _3:10 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:3; Ts:( ( _1:02; _2:05; _3:10 ), ( _1:02; _2:03; _3:05 ), ( _1:03; _2:07; _3:05 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:4; Ts:( ( _1:08; _2:02; _3:00 ), ( _1:08; _2:05; _3:02 ), ( _1:08; _2:07; _3:05 ), ( _1:10; _2:02; _3:05 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:4; Ts:( ( _1:09; _2:00; _3:01 ), ( _1:05; _2:10; _3:03 ), ( _1:05; _2:03; _3:07 ), ( _1:03; _2:10; _3:02 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:5; Ts:( ( _1:09; _2:08; _3:02 ), ( _1:09; _2:02; _3:01 ), ( _1:08; _2:07; _3:02 ), ( _1:10; _2:02; _3:05 ), ( _1:07; _2:05; _3:02 ) ) ),
        ( TsN:4; Ts:( ( _1:02; _2:05; _3:10 ), ( _1:03; _2:05; _3:02 ), ( _1:03; _2:04; _3:05 ), ( _1:03; _2:08; _3:04 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:3; Ts:( ( _1:05; _2:10; _3:02 ), ( _1:05; _2:02; _3:04 ), ( _1:04; _2:02; _3:00 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:5; Ts:( ( _1:03; _2:10; _3:02 ), ( _1:03; _2:05; _3:10 ), ( _1:03; _2:08; _3:05 ), ( _1:04; _2:05; _3:08 ), ( _1:00; _2:01; _3:09 ) ) ),
        ( TsN:4; Ts:( ( _1:05; _2:10; _3:02 ), ( _1:05; _2:02; _3:04 ), ( _1:01; _2:09; _3:02 ), ( _1:09; _2:04; _3:02 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:4; Ts:( ( _1:02; _2:09; _3:10 ), ( _1:02; _2:07; _3:09 ), ( _1:02; _2:03; _3:07 ), ( _1:07; _2:04; _3:09 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:5; Ts:( ( _1:09; _2:10; _3:07 ), ( _1:09; _2:07; _3:04 ), ( _1:10; _2:02; _3:07 ), ( _1:08; _2:07; _3:00 ), ( _1:02; _2:00; _3:07 ) ) ),
        ( TsN:5; Ts:( ( _1:03; _2:07; _3:10 ), ( _1:03; _2:10; _3:02 ), ( _1:07; _2:04; _3:10 ), ( _1:01; _2:10; _3:00 ), ( _1:04; _2:00; _3:10 ) ) ),
        ( TsN:2; Ts:( ( _1:01; _2:10; _3:02 ), ( _1:08; _2:07; _3:04 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:3; Ts:( ( _1:02; _2:03; _3:08 ), ( _1:02; _2:08; _3:10 ), ( _1:10; _2:08; _3:09 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:2; Ts:( ( _1:09; _2:10; _3:02 ), ( _1:00; _2:09; _3:02 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:4; Ts:( ( _1:02; _2:03; _3:08 ), ( _1:02; _2:08; _3:10 ), ( _1:00; _2:01; _3:08 ), ( _1:01; _2:10; _3:08 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:1; Ts:( ( _1:01; _2:10; _3:02 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:3; Ts:( ( _1:11; _2:01; _3:02 ), ( _1:11; _2:07; _3:01 ), ( _1:07; _2:05; _3:01 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:4; Ts:( ( _1:00; _2:08; _3:03 ), ( _1:01; _2:02; _3:07 ), ( _1:01; _2:07; _3:05 ), ( _1:07; _2:02; _3:11 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:4; Ts:( ( _1:09; _2:07; _3:05 ), ( _1:09; _2:02; _3:07 ), ( _1:09; _2:00; _3:02 ), ( _1:02; _2:11; _3:07 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:5; Ts:( ( _1:07; _2:05; _3:02 ), ( _1:07; _2:02; _3:11 ), ( _1:05; _2:09; _3:02 ), ( _1:03; _2:02; _3:08 ), ( _1:09; _2:08; _3:02 ) ) ),
        ( TsN:4; Ts:( ( _1:02; _2:05; _3:01 ), ( _1:02; _2:08; _3:05 ), ( _1:02; _2:11; _3:08 ), ( _1:04; _2:05; _3:08 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:5; Ts:( ( _1:00; _2:04; _3:11 ), ( _1:00; _2:11; _3:03 ), ( _1:04; _2:05; _3:11 ), ( _1:02; _2:11; _3:01 ), ( _1:05; _2:01; _3:11 ) ) ),
        ( TsN:5; Ts:( ( _1:00; _2:02; _3:05 ), ( _1:00; _2:05; _3:09 ), ( _1:02; _2:11; _3:05 ), ( _1:04; _2:05; _3:08 ), ( _1:11; _2:08; _3:05 ) ) ),
        ( TsN:2; Ts:( ( _1:09; _2:04; _3:05 ), ( _1:02; _2:11; _3:03 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:4; Ts:( ( _1:04; _2:11; _3:07 ), ( _1:09; _2:11; _3:04 ), ( _1:09; _2:02; _3:11 ), ( _1:09; _2:01; _3:02 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:5; Ts:( ( _1:09; _2:07; _3:04 ), ( _1:09; _2:11; _3:07 ), ( _1:09; _2:01; _3:11 ), ( _1:02; _2:11; _3:01 ), ( _1:00; _2:08; _3:03 ) ) ),
        ( TsN:3; Ts:( ( _1:11; _2:07; _3:04 ), ( _1:11; _2:04; _3:02 ), ( _1:02; _2:04; _3:00 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:4; Ts:( ( _1:11; _2:07; _3:04 ), ( _1:11; _2:04; _3:02 ), ( _1:08; _2:03; _3:04 ), ( _1:03; _2:02; _3:04 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:3; Ts:( ( _1:01; _2:02; _3:11 ), ( _1:01; _2:11; _3:09 ), ( _1:09; _2:11; _3:08 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:4; Ts:( ( _1:03; _2:00; _3:09 ), ( _1:03; _2:09; _3:11 ), ( _1:01; _2:02; _3:09 ), ( _1:02; _2:11; _3:09 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:2; Ts:( ( _1:00; _2:02; _3:11 ), ( _1:08; _2:00; _3:11 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:1; Ts:( ( _1:03; _2:02; _3:11 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:2; Ts:( ( _1:01; _2:03; _3:05 ), ( _1:03; _2:07; _3:05 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:3; Ts:( ( _1:00; _2:08; _3:07 ), ( _1:00; _2:07; _3:01 ), ( _1:01; _2:07; _3:05 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:3; Ts:( ( _1:09; _2:00; _3:03 ), ( _1:09; _2:03; _3:05 ), ( _1:05; _2:03; _3:07 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:2; Ts:( ( _1:09; _2:08; _3:07 ), ( _1:05; _2:09; _3:07 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:3; Ts:( ( _1:08; _2:04; _3:05 ), ( _1:08; _2:05; _3:03 ), ( _1:03; _2:05; _3:01 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:2; Ts:( ( _1:00; _2:04; _3:05 ), ( _1:01; _2:00; _3:05 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:4; Ts:( ( _1:08; _2:04; _3:05 ), ( _1:08; _2:05; _3:03 ), ( _1:09; _2:00; _3:05 ), ( _1:00; _2:03; _3:05 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:1; Ts:( ( _1:09; _2:04; _3:05 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:3; Ts:( ( _1:04; _2:09; _3:01 ), ( _1:04; _2:01; _3:07 ), ( _1:07; _2:01; _3:03 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:4; Ts:( ( _1:04; _2:09; _3:01 ), ( _1:04; _2:01; _3:07 ), ( _1:00; _2:08; _3:01 ), ( _1:08; _2:07; _3:01 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:2; Ts:( ( _1:04; _2:00; _3:03 ), ( _1:07; _2:04; _3:03 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:1; Ts:( ( _1:04; _2:08; _3:07 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:2; Ts:( ( _1:01; _2:03; _3:08 ), ( _1:09; _2:01; _3:08 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:1; Ts:( ( _1:00; _2:09; _3:01 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:1; Ts:( ( _1:00; _2:03; _3:08 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) ),
        ( TsN:0; Ts:( ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ), ( _1:-1; _2:-1; _3:-1 ) ) )
      );

//var //$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$【変数】

//$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$【ルーチン】

implementation //############################################################### ■

uses System.SysUtils, System.RTLConsts;

//$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$【レコード】

//$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$【クラス】

//%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% TIterMarcube

//&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&& private

//&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&& protected

/////////////////////////////////////////////////////////////////////// アクセス

function TIterMarcube.GetKind :Byte;
begin
     Result := 0;

     if Grids[ 0, 0, 0 ] < 0 then Result := Result or $01;
     if Grids[ 1, 0, 0 ] < 0 then Result := Result or $02;
     if Grids[ 0, 1, 0 ] < 0 then Result := Result or $04;
     if Grids[ 1, 1, 0 ] < 0 then Result := Result or $08;
     if Grids[ 0, 0, 1 ] < 0 then Result := Result or $10;
     if Grids[ 1, 0, 1 ] < 0 then Result := Result or $20;
     if Grids[ 0, 1, 1 ] < 0 then Result := Result or $40;
     if Grids[ 1, 1, 1 ] < 0 then Result := Result or $80;
end;

function TIterMarcube.FindPoin( const I_:Byte ) :Integer;
begin
     with _Parent do
     begin
          case I_ of
           00: Result := EsX[ TInteger3D.Create( GX[0], GY[0], GZ[0] ) ];
           04: Result := EsX[ TInteger3D.Create( GX[0], GY[1], GZ[0] ) ];
           02: Result := EsX[ TInteger3D.Create( GX[0], GY[0], GZ[1] ) ];
           06: Result := EsX[ TInteger3D.Create( GX[0], GY[1], GZ[1] ) ];

           08: Result := EsY[ TInteger3D.Create( GX[0], GY[0], GZ[0] ) ];
           11: Result := EsY[ TInteger3D.Create( GX[0], GY[0], GZ[1] ) ];
           09: Result := EsY[ TInteger3D.Create( GX[1], GY[0], GZ[0] ) ];
           10: Result := EsY[ TInteger3D.Create( GX[1], GY[0], GZ[1] ) ];

           01: Result := EsZ[ TInteger3D.Create( GX[1], GY[0], GZ[0] ) ];
           03: Result := EsZ[ TInteger3D.Create( GX[0], GY[0], GZ[0] ) ];
           05: Result := EsZ[ TInteger3D.Create( GX[1], GY[1], GZ[0] ) ];
           07: Result := EsZ[ TInteger3D.Create( GX[0], GY[1], GZ[0] ) ];

          else Result := -1;
          end;
     end;
end;

//&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&& public

constructor TIterMarcube.Create( Parent_:TMarcubes );
begin
     inherited Create( Parent_.Grids );

     _Parent := Parent_;
end;

//%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% TMarcubes

//&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&& private

//&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&& protected

/////////////////////////////////////////////////////////////////////// アクセス

/////////////////////////////////////////////////////////////////////// メソッド

procedure TMarcubes.Render;
begin
     Context.SetMatrix( TMatrix3D.CreateTranslation( TPoint3D.Create( -Grids.BricsX / 2,
                                                                      -Grids.BricsY / 2,
                                                                      -Grids.BricsZ / 2 ) )
                      * TMatrix3D.CreateScaling( TPoint3D.Create( Width  / Grids.BricsX,
                                                                  Height / Grids.BricsY,
                                                                  Depth  / Grids.BricsZ ) )
                      * AbsoluteMatrix );

     Context.DrawTriangles( _Geometry.VertexBuffer,
                            _Geometry.IndexBuffer,
                            TMaterialSource.ValidMaterial( _Material ),
                            AbsoluteOpacity );
end;

//------------------------------------------------------------------------------

procedure TMarcubes.MakeModel;
var
   X0, X1, Y0, Y1, Z0, Z1 :Integer;
var
   Ps :TArray<TPoin>;
   P :TPoin;
   X, Y, Z, PsN, I, FsN, J :Integer;
   G0, G1, T :Single;
   Fs :array of TInteger3D;
   F :TInteger3D;
begin
     //          200---------201---------202
     //          /|          /|          /|
     //         / |         / |         / |
     //        /  |        /  |        /  |
     //      100---------101---------102  |
     //      /|   |      /|   |      /|   |
     //     / |  210----/-|--211----/-|--212
     //    /  |  /|    /  |  /|    /  |  /|
     //  000---------001---------002  | / |
     //   |   |/  |   |   |/  |   |   |/  |
     //   |  110------|--111------|--112  |
     //   |  /|   |   |  /|   |   |  /|   |
     //   | / |  220--|-/-|--221--|-/-|--222
     //   |/  |  /    |/  |  /    |/  |  /
     //  010---------011---------012  | /
     //   |   |/      |   |/      |   |/
     //   |  120------|--121------|--122
     //   |  /        |  /        |  /
     //   | /         | /         | /
     //   |/          |/          |/
     //  020---------021---------022

     EsX.Clear;
     EsY.Clear;
     EsZ.Clear;

     //////////

     Ps := [];

     for Z := 0 to Grids.BricsZ do
     for Y := 0 to Grids.BricsY do
     begin
          X0 := 0;
          G0 := Grids[ X0, Y, Z ];
          for X1 := 1 to Grids.BricsX do
          begin
               G1 := Grids[ X1, Y, Z ];

               if ( G0 < 0 ) xor ( G1 < 0 ) then
               begin
                    T := G0 / ( G0 - G1 );

                    EsX.Add( TInteger3D.Create( X0, Y, Z ), Length( Ps ) );

                    P.Pos := TPoint3D.Create( X0 + T, Y, Z );
                    P.Nor := TPoint3D.Create( G1-G0, 0, 0 );

                    Ps := Ps + [ P ];
               end;

               X0 := X1;
               G0 := G1;
          end;
     end;

     for X := 0 to Grids.BricsX do
     for Z := 0 to Grids.BricsZ do
     begin
          Y0 := 0;
          G0 := Grids[ X, Y0, Z ];
          for Y1 := 1 to Grids.BricsY do
          begin
               G1 := Grids[ X, Y1, Z ];

               if ( G0 < 0 ) xor ( G1 < 0 ) then
               begin
                    T := G0 / ( G0 - G1 );

                    EsY.Add( TInteger3D.Create( X, Y0, Z ), Length( Ps ) );

                    P.Pos := TPoint3D.Create( X, Y0 + T, Z );
                    P.Nor := TPoint3D.Create( 0, G1-G0, 0 );

                    Ps := Ps + [ P ];
               end;

               Y0 := Y1;
               G0 := G1;
          end;
     end;

     for Y := 0 to Grids.BricsY do
     for X := 0 to Grids.BricsX do
     begin
          Z0 := 0;
          G0 := Grids[ X, Y, Z0 ];
          for Z1 := 1 to Grids.BricsZ do
          begin
               G1 := Grids[ X, Y, Z1 ];

               if ( G0 < 0 ) xor ( G1 < 0 ) then
               begin
                    T := G0 / ( G0 - G1 );

                    EsZ.Add( TInteger3D.Create( X, Y, Z0 ), Length( Ps ) );

                    P.Pos := TPoint3D.Create( X, Y, Z0 + T );
                    P.Nor := TPoint3D.Create( 0, 0, G1-G0 );

                    Ps := Ps + [ P ];
               end;

               Z0 := Z1;
               G0 := G1;
          end;
     end;

     PsN := Length( Ps );

     //////////

     Fs := [];

     for Z := 0 to Grids.BricsZ-1 do
     begin
          for Y := 0 to Grids.BricsY-1 do
          begin
               _Cube.Pos := TInteger3D.Create( 0, Y, Z );

               for X := 0 to Grids.BricsX-1 do
               begin
                    with TRIASTABLE[ _Cube.Kind ] do
                    begin
                         if TsN > 0 then
                         begin
                              for I := 1 to TsN do
                              begin
                                   with Ts[ I ] do
                                   begin
                                        F._1 := _Cube.FindPoin( _1 );
                                        F._2 := _Cube.FindPoin( _2 );
                                        F._3 := _Cube.FindPoin( _3 );
                                   end;

                                   Fs := Fs + [ F ];
                              end
                         end
                    end;

                    _Cube.GoNextX;
               end;
          end;
     end;

     FsN := Length( Fs );

     //////////

     EsX.Clear;
     EsY.Clear;
     EsZ.Clear;

     with _Geometry do
     begin
          with VertexBuffer do
          begin
               Length := PsN{Vert};

               for I := 0 to PsN-1 do
               begin
                    with Ps[ I ] do
                    begin
                         Vertices[ I ] := Pos;
                         Normals [ I ] := Nor;
                    end;
               end;
          end;

          with IndexBuffer do
          begin
               Length := FsN{Face} * 3{Vert/Face};

               J := 0;
               for I := 0 to FsN-1 do
               begin
                    Indices[ J ] := Fs[ I ]._3;  Inc( J );
                    Indices[ J ] := Fs[ I ]._2;  Inc( J );
                    Indices[ J ] := Fs[ I ]._1;  Inc( J );
               end;
          end;
     end;

     Repaint;
end;

//&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&& public

constructor TMarcubes.Create( AOwner_:TComponent );
begin
     inherited;

     EsX := TDictionary<TInteger3D,Integer>.Create;
     EsY := TDictionary<TInteger3D,Integer>.Create;
     EsZ := TDictionary<TInteger3D,Integer>.Create;

     _Geometry := TMeshData.Create;
     _Material := nil;
     _Grids    := TGridArray3D<Single>.Create;
     _Cube     := TIterMarcube.Create( Self );

     _Grids.BricsX := 10;
     _Grids.BricsY := 10;
     _Grids.BricsZ := 10;
end;

destructor TMarcubes.Destroy;
begin
     _Grids   .DisposeOf;
     _Geometry.DisposeOf;

     EsX.DisposeOf;
     EsY.DisposeOf;
     EsZ.DisposeOf;

     inherited;
end;

/////////////////////////////////////////////////////////////////////// メソッド

procedure TMarcubes.EndUpdate;
begin
     inherited;

     if FUpdating = 0 then MakeModel;
end;

//$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$【ルーチン】

//############################################################################## □

initialization //$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$ 初期化

finalization //$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$ 最終化

end. //######################################################################### ■
